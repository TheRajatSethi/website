
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pandas cheatsheet &#8212; Rajat Sethi  documentation</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Blog" href="../../blog.html" />
    <link rel="prev" title="Data Science" href="index.html" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" /> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../blog/atom.xml"
  title="Rajat Sethi"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <p class="title">Rajat Sethi</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">Curated Articles</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../blog.html">Blog</a>
        </li>
        
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/therajatsethi" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/therajatsethi" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar">
<h3><a href="../../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Curated Articles</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Data Science</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../blog.html">Blog</a></li>
</ul>

<h3>
  <a href="../../blog.html">Recent Posts</a>
</h3>
<ul>
   
  <li>
    <a href="../../blog/2021/blogging-with-sphinx.html"
      >21 February - Blogging with Sphinx</a
    >
  </li>
  
</ul>

          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#input-output" class="nav-link">Input & Output</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#snippets" class="nav-link">Snippets</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#selecting-indexing" class="nav-link">Selecting & Indexing</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#id1" class="nav-link">Snippets</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#using-functions-s-for-selection" class="nav-link">Using functions’s for selection</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#combine-positional-and-label-to-select-data" class="nav-link">Combine positional and label to select data</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#boolean-indexing" class="nav-link">Boolean Indexing</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#where" class="nav-link">Where</a>
        </li>
    
        <li class="nav-item toc-entry toc-h4">
            <a href="#query" class="nav-link">Query</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#multiindexing-and-advanced-indexing" class="nav-link">MultiIndexing and Advanced Indexing</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#setting-options" class="nav-link">Setting options</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#text" class="nav-link">Text</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#id2" class="nav-link">Snippets</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#merge-joins" class="nav-link">Merge & Joins</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#grouping-aggregations" class="nav-link">Grouping & Aggregations</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#id3" class="nav-link">Snippets</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#named-aggregation" class="nav-link">Named Aggregation</a>
        </li>
    
            </ul>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#timeseries" class="nav-link">TimeSeries</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                 <div class="section" id="pandas-cheatsheet">
<h1>Pandas cheatsheet<a class="headerlink" href="#pandas-cheatsheet" title="Permalink to this headline">¶</a></h1>
<p>This cheatsheet lists out important and most used pandas functionality.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">.</span><span class="nc">dataframe</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mf">10.5</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#3b3b3b</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">dataframe</span> <span class="nt">td</span> <span class="p">{</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mf">10.5</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#3b3b3b</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dataframe th {
    font-size: 10.5px;
    color: #3b3b3b;
}
.dataframe td {
    font-size: 10.5px;
    color: #3b3b3b;
}
</style>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Setting optimal options for cheatsheet.</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="input-output">
<h2>Input &amp; Output<a class="headerlink" href="#input-output" title="Permalink to this headline">¶</a></h2>
<p>Pandas input and output functions.</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code></p></td>
<td><p>reads data from csv file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pd.to_csv()</span></code></p></td>
<td><p>writes data to csv file</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pd.read_sql</span></code></p></td>
<td><p>reads from sql</p></td>
</tr>
</tbody>
</table>
<div class="section" id="snippets">
<h3>Snippets<a class="headerlink" href="#snippets" title="Permalink to this headline">¶</a></h3>
<p><strong>Reading from mysql</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">import</span> <span class="nn">pymysql</span>

<span class="n">db_connection_str</span> <span class="o">=</span> <span class="s1">&#39;mysql+pymysql://user_name:password@mysqlhost/database_name&#39;</span>
<span class="n">db_connection</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">db_connection_str</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM customers&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db_connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="selecting-indexing">
<h2>Selecting &amp; Indexing<a class="headerlink" href="#selecting-indexing" title="Permalink to this headline">¶</a></h2>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df['col']</span></code></p></td>
<td><p>Selects a single column</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df[['col1',</span> <span class="pre">'col2']]</span></code></p></td>
<td><p>Selects multiple columns. Pass in a list of columns.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.loc[index]</span></code></p></td>
<td><p>selects single row</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.loc[[index1,index2],</span> <span class="pre">[col1,</span> <span class="pre">col2]]</span></code></p></td>
<td><p>selects specified rows and columns</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.loc[start_index:end_index,</span> <span class="pre">start_col:end_col]</span></code></p></td>
<td><p>slices rows and slices columns (end value is included unlike Python). Standard slicing is supported e.g. <code class="docutils literal notranslate"><span class="pre">dfl.loc['index':,::-1]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.sort_index()</span></code></p></td>
<td><p>sorts row based on index</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.iloc[]</span></code></p></td>
<td><p>selects by position not label</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.index[position]</span></code></p></td>
<td><p>gives index for a position</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.index[[pos1,</span> <span class="pre">pos2,</span> <span class="pre">..,</span> <span class="pre">posn]]</span></code></p></td>
<td><p>gives index for requested positions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.set_index[[col,</span> <span class="pre">col]]</span></code></p></td>
<td><p>Ability to set single or multi-index.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.sample()</span></code></p></td>
<td><p>gives back a random sample. You can pass in the count or the fraction.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.columns.get_loc('col_name')</span></code></p></td>
<td><p>returns location for a particular column</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.columns.get_indexer(['col_name',</span> <span class="pre">'col_name'])</span></code></p></td>
<td><p>returns location for a particular columns</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">&amp;</span> <span class="pre">~</span></code></p></td>
<td><p>used for boolean indexing</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">series.isin(iterable)</span></code></p></td>
<td><p>returns True if value is in iterable</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">series/df.where(filter_condition,</span> <span class="pre">default</span> <span class="pre">value)</span></code></p></td>
<td><p>returns the same shape as original df and not a subset like boolean indexing</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.query('expression')</span></code></p></td>
<td><p>querys based on string experssion</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.duplicated([col,</span> <span class="pre">col])</span></code></p></td>
<td><p>duplicacy checks</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.drop_duplicates([col,</span> <span class="pre">col],</span> <span class="pre">keep='first')</span></code></p></td>
<td><p>drop duplicate where keep can be last or first or False</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">series.get(index,</span> <span class="pre">default=___)</span></code></p></td>
<td><p>dict like get method</p></td>
</tr>
</tbody>
</table>
<div class="section" id="id1">
<h3>Snippets<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p><strong>Using conditionals on a single row to filter out columns. The below example would work on row which has all integers</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">))</span>

<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.786073</td>
      <td>0.241026</td>
      <td>1.836268</td>
      <td>1.130302</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.440493</td>
      <td>1.617552</td>
      <td>-0.068282</td>
      <td>-0.022670</td>
    </tr>
    <tr>
      <th>c</th>
      <td>-1.559774</td>
      <td>0.603044</td>
      <td>-1.606989</td>
      <td>0.814513</td>
    </tr>
    <tr>
      <th>d</th>
      <td>-0.091140</td>
      <td>-0.616634</td>
      <td>-0.000725</td>
      <td>0.047443</td>
    </tr>
    <tr>
      <th>e</th>
      <td>0.274607</td>
      <td>0.033709</td>
      <td>-0.676457</td>
      <td>-0.480869</td>
    </tr>
    <tr>
      <th>f</th>
      <td>0.273721</td>
      <td>-0.947775</td>
      <td>0.773054</td>
      <td>1.152777</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creates a mask for a single row to filter out the cols ==&gt; df1.loc[&#39;a&#39;] &gt; 0</span>

<span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.786073</td>
      <td>0.241026</td>
      <td>1.836268</td>
      <td>1.130302</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.440493</td>
      <td>1.617552</td>
      <td>-0.068282</td>
      <td>-0.022670</td>
    </tr>
    <tr>
      <th>c</th>
      <td>-1.559774</td>
      <td>0.603044</td>
      <td>-1.606989</td>
      <td>0.814513</td>
    </tr>
    <tr>
      <th>d</th>
      <td>-0.091140</td>
      <td>-0.616634</td>
      <td>-0.000725</td>
      <td>0.047443</td>
    </tr>
    <tr>
      <th>e</th>
      <td>0.274607</td>
      <td>0.033709</td>
      <td>-0.676457</td>
      <td>-0.480869</td>
    </tr>
    <tr>
      <th>f</th>
      <td>0.273721</td>
      <td>-0.947775</td>
      <td>0.773054</td>
      <td>1.152777</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="using-functions-s-for-selection">
<h4>Using functions’s for selection<a class="headerlink" href="#using-functions-s-for-selection" title="Permalink to this headline">¶</a></h4>
<p>The function should take one argument.</p>
<p>Selecting rows from DataFrame where the column <em>base_salary</em> has value greater than 50K.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">emp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/employee.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;unique_id&#39;</span><span class="p">)</span>
<span class="n">emp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>gender</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>ASSISTANT DIRECTOR (EX LVL)</td>
      <td>Municipal Courts Department</td>
      <td>121862.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2006-06-12</td>
      <td>2012-10-13</td>
    </tr>
    <tr>
      <th>20</th>
      <td>LIBRARY ASSISTANT</td>
      <td>Library</td>
      <td>26125.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2000-07-19</td>
      <td>2010-09-18</td>
    </tr>
    <tr>
      <th>30</th>
      <td>POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>45279.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2015-02-03</td>
      <td>2015-02-03</td>
    </tr>
    <tr>
      <th>40</th>
      <td>ENGINEER/OPERATOR</td>
      <td>Houston Fire Department (HFD)</td>
      <td>63166.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1982-02-08</td>
      <td>1991-05-25</td>
    </tr>
    <tr>
      <th>50</th>
      <td>ELECTRICIAN</td>
      <td>General Services Department</td>
      <td>56347.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1989-06-19</td>
      <td>1994-10-22</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19960</th>
      <td>POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>43443.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2014-06-09</td>
      <td>2015-06-09</td>
    </tr>
    <tr>
      <th>19970</th>
      <td>COMMUNICATIONS CAPTAIN</td>
      <td>Houston Fire Department (HFD)</td>
      <td>66523.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2003-09-02</td>
      <td>2013-10-06</td>
    </tr>
    <tr>
      <th>19980</th>
      <td>POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>43443.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2014-10-13</td>
      <td>2015-10-13</td>
    </tr>
    <tr>
      <th>19990</th>
      <td>POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>55461.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2009-01-20</td>
      <td>2011-07-02</td>
    </tr>
    <tr>
      <th>20000</th>
      <td>FIRE FIGHTER</td>
      <td>Houston Fire Department (HFD)</td>
      <td>51194.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2009-01-12</td>
      <td>2010-07-12</td>
    </tr>
  </tbody>
</table>
<p>2000 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">emp</span><span class="p">[</span><span class="s1">&#39;base_salary&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">150000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>gender</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>120</th>
      <td>CHIEF PHYSICIAN,MD</td>
      <td>Health &amp; Human Services</td>
      <td>180416.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1987-05-22</td>
      <td>1999-08-28</td>
    </tr>
    <tr>
      <th>440</th>
      <td>ASSOCIATE EMS PHYSICIAN DIRECTOR</td>
      <td>Houston Fire Department (HFD)</td>
      <td>165216.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2013-08-31</td>
      <td>2013-08-31</td>
    </tr>
    <tr>
      <th>1790</th>
      <td>ASSOCIATE EMS PHYSICIAN DIRECTOR,MD</td>
      <td>Houston Fire Department (HFD)</td>
      <td>210588.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2001-09-05</td>
      <td>2003-05-10</td>
    </tr>
    <tr>
      <th>5940</th>
      <td>CITY ATTORNEY</td>
      <td>Legal Department</td>
      <td>275000.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2016-05-02</td>
      <td>2016-05-02</td>
    </tr>
    <tr>
      <th>6060</th>
      <td>DEPUTY DIRECTOR (EXECUTIVE LEVEL)</td>
      <td>Houston Airport System (HAS)</td>
      <td>150416.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2013-06-10</td>
      <td>2013-06-10</td>
    </tr>
    <tr>
      <th>7200</th>
      <td>DEPUTY DIRECTOR (EXECUTIVE LEVEL)</td>
      <td>Houston Police Department-HPD</td>
      <td>163228.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1977-07-20</td>
      <td>1998-08-08</td>
    </tr>
    <tr>
      <th>7430</th>
      <td>SENIOR ASSISTANT CITY ATTORNEY II</td>
      <td>Legal Department</td>
      <td>150416.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2012-06-11</td>
      <td>2013-07-06</td>
    </tr>
    <tr>
      <th>7680</th>
      <td>DEPUTY DIRECTOR-FINANCE &amp; ADMINISTRATION</td>
      <td>Houston Police Department-HPD</td>
      <td>199596.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2007-02-01</td>
      <td>2007-02-01</td>
    </tr>
    <tr>
      <th>8560</th>
      <td>DEPUTY DIRECTOR-AVIATION (EX LVL)</td>
      <td>Houston Airport System (HAS)</td>
      <td>186192.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2013-08-22</td>
      <td>2014-08-16</td>
    </tr>
    <tr>
      <th>12330</th>
      <td>DEPUTY DIRECTOR-PUBLIC WORKS (EXECUTIVE</td>
      <td>Public Works &amp; Engineering-PWE</td>
      <td>178331.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>1991-02-12</td>
      <td>2005-05-14</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="combine-positional-and-label-to-select-data">
<h4>Combine positional and label to select data<a class="headerlink" href="#combine-positional-and-label-to-select-data" title="Permalink to this headline">¶</a></h4>
<p>In the below example <code class="docutils literal notranslate"><span class="pre">df.index[0:10:4]</span></code> provides the index for every 4th row from 0 to 10 position.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">emp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;base_salary&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gender</th>
      <th>base_salary</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>Female</td>
      <td>121862.0</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Male</td>
      <td>56347.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Male</td>
      <td>107962.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In the below example <code class="docutils literal notranslate"><span class="pre">df.columns.get_loc('base_salary')</span></code> returns the integer position of the column base_salary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">emp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">emp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;base_salary&#39;</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>unique_id
10    121862.0
50     56347.0
Name: base_salary, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>In the below example <code class="docutils literal notranslate"><span class="pre">df.columns.get_indexer(['base_salary',</span> <span class="pre">'gender'</span> <span class="pre">])</span></code> returns the integer position of the all specified columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">emp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">([</span><span class="s1">&#39;base_salary&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span> <span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>base_salary</th>
      <th>gender</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>121862.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>50</th>
      <td>56347.0</td>
      <td>Male</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="boolean-indexing">
<h4>Boolean Indexing<a class="headerlink" href="#boolean-indexing" title="Permalink to this headline">¶</a></h4>
<p>Tip : Use () to seperate the comparisons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;base_salary&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;employment_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Active&#39;</span><span class="p">)</span>
<span class="n">emp</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>gender</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>ASSISTANT DIRECTOR (EX LVL)</td>
      <td>Municipal Courts Department</td>
      <td>121862.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2006-06-12</td>
      <td>2012-10-13</td>
    </tr>
    <tr>
      <th>20</th>
      <td>LIBRARY ASSISTANT</td>
      <td>Library</td>
      <td>26125.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2000-07-19</td>
      <td>2010-09-18</td>
    </tr>
    <tr>
      <th>90</th>
      <td>DEPUTY ASSISTANT DIRECTOR (EXECUTIVE LEV</td>
      <td>Public Works &amp; Engineering-PWE</td>
      <td>107962.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1993-11-15</td>
      <td>2013-01-05</td>
    </tr>
    <tr>
      <th>120</th>
      <td>CHIEF PHYSICIAN,MD</td>
      <td>Health &amp; Human Services</td>
      <td>180416.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1987-05-22</td>
      <td>1999-08-28</td>
    </tr>
    <tr>
      <th>360</th>
      <td>DENTAL ASSISTANT</td>
      <td>Health &amp; Human Services</td>
      <td>34923.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>1982-04-05</td>
      <td>1990-11-03</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19840</th>
      <td>ADMINISTRATIVE SPECIALIST</td>
      <td>Admn. &amp; Regulatory Affairs</td>
      <td>55172.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2006-10-16</td>
      <td>2006-10-16</td>
    </tr>
    <tr>
      <th>19890</th>
      <td>SENIOR ASSISTANT CITY ATTORNEY II</td>
      <td>Legal Department</td>
      <td>124115.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>2013-01-23</td>
      <td>2013-03-02</td>
    </tr>
    <tr>
      <th>19910</th>
      <td>BUILDING MAINTENANCE SUPERVISOR</td>
      <td>Parks &amp; Recreation</td>
      <td>30347.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>1995-10-14</td>
      <td>2010-03-20</td>
    </tr>
    <tr>
      <th>19920</th>
      <td>MOBILITY SERVICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>44429.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2005-09-12</td>
      <td>2007-06-02</td>
    </tr>
    <tr>
      <th>19950</th>
      <td>POLICE CAPTAIN</td>
      <td>Houston Police Department-HPD</td>
      <td>104455.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1983-02-07</td>
      <td>2004-07-08</td>
    </tr>
  </tbody>
</table>
<p>639 rows × 7 columns</p>
</div></div></div>
</div>
<p>A little bit more complicated example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">occupations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;POLICE OFFICER&#39;</span><span class="p">,</span> <span class="s1">&#39;SENIOR POLICE OFFICER&#39;</span><span class="p">]</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;position_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">occupations</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;base_salary&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">))</span>
<span class="n">emp</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>gender</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>SENIOR POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>66614.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1984-11-26</td>
      <td>2005-03-26</td>
    </tr>
    <tr>
      <th>200</th>
      <td>SENIOR POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>66614.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1992-02-17</td>
      <td>2007-07-28</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write above using isin</span>

<span class="n">mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;position_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">occupations</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;base_salary&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">))</span>
<span class="n">emp</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>gender</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>SENIOR POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>66614.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1984-11-26</td>
      <td>2005-03-26</td>
    </tr>
    <tr>
      <th>200</th>
      <td>SENIOR POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>66614.0</td>
      <td>Male</td>
      <td>Active</td>
      <td>1992-02-17</td>
      <td>2007-07-28</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="where">
<h4>Where<a class="headerlink" href="#where" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>gender</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>ASSISTANT DIRECTOR (EX LVL)</td>
      <td>Municipal Courts Department</td>
      <td>121862</td>
      <td>Female</td>
      <td>Active</td>
      <td>2006-06-12</td>
      <td>2012-10-13</td>
    </tr>
    <tr>
      <th>20</th>
      <td>LIBRARY ASSISTANT</td>
      <td>Library</td>
      <td>26125</td>
      <td>Female</td>
      <td>Active</td>
      <td>2000-07-19</td>
      <td>2010-09-18</td>
    </tr>
    <tr>
      <th>30</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>50</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19960</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19970</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19980</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19990</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20000</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>2000 rows × 7 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="query">
<h4>Query<a class="headerlink" href="#query" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">emp</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;base_salary &gt; 100000 and employment_status == &quot;Active&quot; and gender == &quot;Female&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>gender</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>ASSISTANT DIRECTOR (EX LVL)</td>
      <td>Municipal Courts Department</td>
      <td>121862.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2006-06-12</td>
      <td>2012-10-13</td>
    </tr>
    <tr>
      <th>670</th>
      <td>PUBLIC HEALTH DENTIST,DDS</td>
      <td>Health &amp; Human Services</td>
      <td>100791.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2015-12-28</td>
      <td>2015-12-28</td>
    </tr>
    <tr>
      <th>2380</th>
      <td>ASSISTANT DIRECTOR (EXECUTIVE LEVEL)</td>
      <td>Admn. &amp; Regulatory Affairs</td>
      <td>130416.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2002-05-24</td>
      <td>2013-07-20</td>
    </tr>
    <tr>
      <th>3670</th>
      <td>DEPUTY ASSISTANT DIRECTOR (EXECUTIVE LEV</td>
      <td>Mayor's Office</td>
      <td>110000.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2014-05-13</td>
      <td>2014-05-13</td>
    </tr>
    <tr>
      <th>5230</th>
      <td>DEPUTY ASSISTANT DIRECTOR (EX LVL)</td>
      <td>Houston Airport System (HAS)</td>
      <td>110686.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2011-11-07</td>
      <td>2011-11-07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15610</th>
      <td>SENIOR ASSISTANT CITY ATTORNEY II</td>
      <td>Legal Department</td>
      <td>122220.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2005-09-12</td>
      <td>2012-07-21</td>
    </tr>
    <tr>
      <th>17790</th>
      <td>DIVISION MANAGER</td>
      <td>Human Resources Dept.</td>
      <td>110547.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2000-01-29</td>
      <td>2010-12-25</td>
    </tr>
    <tr>
      <th>17850</th>
      <td>JUDGE OF MUNICIPAL COURTS</td>
      <td>Municipal Courts Department</td>
      <td>117176.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>1999-09-25</td>
      <td>2010-11-13</td>
    </tr>
    <tr>
      <th>19440</th>
      <td>ASSISTANT DIRECTOR (EXECUTIVE LEVEL)</td>
      <td>Houston Airport System (HAS)</td>
      <td>128606.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>1993-02-22</td>
      <td>2004-09-04</td>
    </tr>
    <tr>
      <th>19470</th>
      <td>SENIOR ASSISTANT CITY ATTORNEY II</td>
      <td>Legal Department</td>
      <td>117831.0</td>
      <td>Female</td>
      <td>Active</td>
      <td>2005-07-18</td>
      <td>2012-07-21</td>
    </tr>
  </tbody>
</table>
<p>21 rows × 7 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="multiindexing-and-advanced-indexing">
<h3>MultiIndexing and Advanced Indexing<a class="headerlink" href="#multiindexing-and-advanced-indexing" title="Permalink to this headline">¶</a></h3>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pd.MultiIndex.from_*</span></code></p></td>
<td><p>Set of methods which create multiindex from various sources such as tuples, arrays …</p></td>
</tr>
</tbody>
</table>
<p>Setting multiple indexes on a dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">emp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/employee.csv&#39;</span><span class="p">)</span>
<span class="n">emp</span> <span class="o">=</span> <span class="n">emp</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="s1">&#39;unique_id&#39;</span><span class="p">])</span>
<span class="n">emp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>gender</th>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Female</th>
      <th>10</th>
      <td>ASSISTANT DIRECTOR (EX LVL)</td>
      <td>Municipal Courts Department</td>
      <td>121862.0</td>
      <td>Active</td>
      <td>2006-06-12</td>
      <td>2012-10-13</td>
    </tr>
    <tr>
      <th>20</th>
      <td>LIBRARY ASSISTANT</td>
      <td>Library</td>
      <td>26125.0</td>
      <td>Active</td>
      <td>2000-07-19</td>
      <td>2010-09-18</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">Male</th>
      <th>30</th>
      <td>POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>45279.0</td>
      <td>Active</td>
      <td>2015-02-03</td>
      <td>2015-02-03</td>
    </tr>
    <tr>
      <th>40</th>
      <td>ENGINEER/OPERATOR</td>
      <td>Houston Fire Department (HFD)</td>
      <td>63166.0</td>
      <td>Active</td>
      <td>1982-02-08</td>
      <td>1991-05-25</td>
    </tr>
    <tr>
      <th>50</th>
      <td>ELECTRICIAN</td>
      <td>General Services Department</td>
      <td>56347.0</td>
      <td>Active</td>
      <td>1989-06-19</td>
      <td>1994-10-22</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19960</th>
      <td>POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>43443.0</td>
      <td>Active</td>
      <td>2014-06-09</td>
      <td>2015-06-09</td>
    </tr>
    <tr>
      <th>19970</th>
      <td>COMMUNICATIONS CAPTAIN</td>
      <td>Houston Fire Department (HFD)</td>
      <td>66523.0</td>
      <td>Active</td>
      <td>2003-09-02</td>
      <td>2013-10-06</td>
    </tr>
    <tr>
      <th>19980</th>
      <td>POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>43443.0</td>
      <td>Active</td>
      <td>2014-10-13</td>
      <td>2015-10-13</td>
    </tr>
    <tr>
      <th>19990</th>
      <td>POLICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>55461.0</td>
      <td>Active</td>
      <td>2009-01-20</td>
      <td>2011-07-02</td>
    </tr>
    <tr>
      <th>20000</th>
      <td>FIRE FIGHTER</td>
      <td>Houston Fire Department (HFD)</td>
      <td>51194.0</td>
      <td>Active</td>
      <td>2009-01-12</td>
      <td>2010-07-12</td>
    </tr>
  </tbody>
</table>
<p>2000 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Female&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>ASSISTANT DIRECTOR (EX LVL)</td>
      <td>Municipal Courts Department</td>
      <td>121862.0</td>
      <td>Active</td>
      <td>2006-06-12</td>
      <td>2012-10-13</td>
    </tr>
    <tr>
      <th>20</th>
      <td>LIBRARY ASSISTANT</td>
      <td>Library</td>
      <td>26125.0</td>
      <td>Active</td>
      <td>2000-07-19</td>
      <td>2010-09-18</td>
    </tr>
    <tr>
      <th>360</th>
      <td>DENTAL ASSISTANT</td>
      <td>Health &amp; Human Services</td>
      <td>34923.0</td>
      <td>Active</td>
      <td>1982-04-05</td>
      <td>1990-11-03</td>
    </tr>
    <tr>
      <th>370</th>
      <td>SENIOR INSPECTOR</td>
      <td>Public Works &amp; Engineering-PWE</td>
      <td>60258.0</td>
      <td>Active</td>
      <td>2004-08-03</td>
      <td>2007-03-10</td>
    </tr>
    <tr>
      <th>390</th>
      <td>SENIOR MICROCOMPUTER ANALYST</td>
      <td>Health &amp; Human Services</td>
      <td>67499.0</td>
      <td>Active</td>
      <td>1994-06-29</td>
      <td>1997-08-30</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19770</th>
      <td>SENIOR SIDELOADER OPERATOR</td>
      <td>Solid Waste Management</td>
      <td>34466.0</td>
      <td>Active</td>
      <td>2015-07-20</td>
      <td>2016-01-30</td>
    </tr>
    <tr>
      <th>19790</th>
      <td>POLICE SERVICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>27914.0</td>
      <td>Active</td>
      <td>2011-10-14</td>
      <td>2014-03-01</td>
    </tr>
    <tr>
      <th>19840</th>
      <td>ADMINISTRATIVE SPECIALIST</td>
      <td>Admn. &amp; Regulatory Affairs</td>
      <td>55172.0</td>
      <td>Active</td>
      <td>2006-10-16</td>
      <td>2006-10-16</td>
    </tr>
    <tr>
      <th>19910</th>
      <td>BUILDING MAINTENANCE SUPERVISOR</td>
      <td>Parks &amp; Recreation</td>
      <td>30347.0</td>
      <td>Active</td>
      <td>1995-10-14</td>
      <td>2010-03-20</td>
    </tr>
    <tr>
      <th>19920</th>
      <td>MOBILITY SERVICE OFFICER</td>
      <td>Houston Police Department-HPD</td>
      <td>44429.0</td>
      <td>Active</td>
      <td>2005-09-12</td>
      <td>2007-06-02</td>
    </tr>
  </tbody>
</table>
<p>603 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Female&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>position_title       ASSISTANT DIRECTOR (EX LVL)
department           Municipal Courts Department
base_salary                               121862
employment_status                         Active
hire_date                             2006-06-12
job_date                              2012-10-13
Name: 10, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="setting-options">
<h2>Setting options<a class="headerlink" href="#setting-options" title="Permalink to this headline">¶</a></h2>
<p>You can set options for pandas using <code class="docutils literal notranslate"><span class="pre">set_option</span></code> method e.g. <code class="docutils literal notranslate"><span class="pre">pd.set_option('display.width',</span> <span class="pre">None)</span></code></p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">display.width</span></code></p></td>
<td><p>Use full width of terminal</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">display.max_columns</span></code></p></td>
<td><p>Set as <code class="docutils literal notranslate"><span class="pre">None</span></code> to display all cols</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="text">
<h2>Text<a class="headerlink" href="#text" title="Permalink to this headline">¶</a></h2>
<p>Refer to the following <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/text.html#method-summary">link</a> to get various string related methods and their uses.</p>
<p>String methods are used as follows <code class="docutils literal notranslate"><span class="pre">Series.str.method()</span></code>, to chain follow the pattern  <code class="docutils literal notranslate"><span class="pre">Series.str.method().str.method()</span></code></p>
<div class="section" id="id2">
<h3>Snippets<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="p">[</span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;department&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Lib&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>position_title</th>
      <th>department</th>
      <th>base_salary</th>
      <th>employment_status</th>
      <th>hire_date</th>
      <th>job_date</th>
    </tr>
    <tr>
      <th>gender</th>
      <th>unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Female</th>
      <th>20</th>
      <td>LIBRARY ASSISTANT</td>
      <td>Library</td>
      <td>26125.0</td>
      <td>Active</td>
      <td>2000-07-19</td>
      <td>2010-09-18</td>
    </tr>
    <tr>
      <th>1020</th>
      <td>CUSTOMER SERVICE CLERK</td>
      <td>Library</td>
      <td>NaN</td>
      <td>Active</td>
      <td>2016-02-29</td>
      <td>2016-02-29</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Male</th>
      <th>2810</th>
      <td>SENIOR CUSTOMER SERVICE CLERK</td>
      <td>Library</td>
      <td>31034.0</td>
      <td>Active</td>
      <td>2012-11-13</td>
      <td>2015-12-19</td>
    </tr>
    <tr>
      <th>2990</th>
      <td>SENIOR LIBRARY SERVICE SPECIALIST</td>
      <td>Library</td>
      <td>38563.0</td>
      <td>Active</td>
      <td>2012-03-05</td>
      <td>2015-02-28</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Female</th>
      <th>3090</th>
      <td>LIBRARIAN II</td>
      <td>Library</td>
      <td>49317.0</td>
      <td>Active</td>
      <td>2014-08-04</td>
      <td>2015-10-10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>18470</th>
      <td>LIBRARY ASSISTANT</td>
      <td>Library</td>
      <td>26125.0</td>
      <td>Active</td>
      <td>2008-05-05</td>
      <td>2013-01-19</td>
    </tr>
    <tr>
      <th>Male</th>
      <th>18970</th>
      <td>DATA BASE ANALYST</td>
      <td>Library</td>
      <td>59371.0</td>
      <td>Active</td>
      <td>2005-08-06</td>
      <td>2013-10-26</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Female</th>
      <th>19270</th>
      <td>LIBRARIAN I</td>
      <td>Library</td>
      <td>39874.0</td>
      <td>Active</td>
      <td>2009-02-11</td>
      <td>2014-10-11</td>
    </tr>
    <tr>
      <th>19640</th>
      <td>SENIOR COMMUNITY LIAISON</td>
      <td>Library</td>
      <td>51542.0</td>
      <td>Active</td>
      <td>2015-11-02</td>
      <td>2015-11-02</td>
    </tr>
    <tr>
      <th>19690</th>
      <td>CUSTOMER SERVICE CLERK</td>
      <td>Library</td>
      <td>NaN</td>
      <td>Active</td>
      <td>2013-08-05</td>
      <td>2013-08-05</td>
    </tr>
  </tbody>
</table>
<p>36 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">emp</span><span class="p">[</span><span class="s1">&#39;department&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gender  unique_id
Female  10              [municipal, courts, department]
        20                                    [library]
Male    30            [houston, police, department-hpd]
        40           [houston, fire, department, (hfd)]
        50              [general, services, department]
                                    ...                
        19960         [houston, police, department-hpd]
        19970        [houston, fire, department, (hfd)]
        19980         [houston, police, department-hpd]
        19990         [houston, police, department-hpd]
        20000        [houston, fire, department, (hfd)]
Name: department, Length: 2000, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="merge-joins">
<h2>Merge &amp; Joins<a class="headerlink" href="#merge-joins" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="grouping-aggregations">
<h2>Grouping &amp; Aggregations<a class="headerlink" href="#grouping-aggregations" title="Permalink to this headline">¶</a></h2>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.groupby('colname')</span></code></p></td>
<td><p>Groupby a single column</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.groupby(['colname',</span> <span class="pre">'colname'])</span></code></p></td>
<td><p>Groupby multiple columns in order of listing</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.groupby(colname)[col].agg(agg_function)</span></code></p></td>
<td><p>Aggregate on a column after group by</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.groupby([col,</span> <span class="pre">col])[[col,</span> <span class="pre">col]].agg([func1,</span> <span class="pre">func2])</span></code></p></td>
<td><p>Aggregate multiple funcs on multi column after group by on multi cols.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.groupby([col,</span> <span class="pre">col])[[col,</span> <span class="pre">col]].agg({col:[func1,</span> <span class="pre">func2],</span> <span class="pre">col[func3,</span> <span class="pre">func4]})</span></code></p></td>
<td><p>Aggregate multiple funcs on multi column after group by on multi cols. (Seperate aggregation for seperate cols.)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">df.groupby(colname)[col].agg(agg_function).rename(columns</span> <span class="pre">=</span> <span class="pre">{})</span></code></p></td>
<td><p>rename cols</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df.groupby(colname).agg(final_col_name</span> <span class="pre">=</span> <span class="pre">pd.NamedAgg(column=aggregate_on_col,</span> <span class="pre">aggfunc=func_name))</span></code></p></td>
<td><p>Named Aggregation</p></td>
</tr>
</tbody>
</table>
<div class="section" id="id3">
<h3>Snippets<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/flights.csv&#39;</span><span class="p">)</span>
<span class="n">flights</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>SLC</td>
      <td>1625</td>
      <td>58.0</td>
      <td>94.0</td>
      <td>590</td>
      <td>1905</td>
      <td>65.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>UA</td>
      <td>DEN</td>
      <td>IAD</td>
      <td>823</td>
      <td>7.0</td>
      <td>154.0</td>
      <td>1452</td>
      <td>1333</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>VPS</td>
      <td>1305</td>
      <td>36.0</td>
      <td>85.0</td>
      <td>641</td>
      <td>1453</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>DCA</td>
      <td>1555</td>
      <td>7.0</td>
      <td>126.0</td>
      <td>1192</td>
      <td>1935</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>MCI</td>
      <td>1720</td>
      <td>48.0</td>
      <td>166.0</td>
      <td>1363</td>
      <td>2225</td>
      <td>39.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58487</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AA</td>
      <td>SFO</td>
      <td>DFW</td>
      <td>515</td>
      <td>5.0</td>
      <td>166.0</td>
      <td>1464</td>
      <td>1045</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58488</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>F9</td>
      <td>LAS</td>
      <td>SFO</td>
      <td>1910</td>
      <td>13.0</td>
      <td>71.0</td>
      <td>414</td>
      <td>2050</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58489</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>SFO</td>
      <td>SBA</td>
      <td>1846</td>
      <td>-6.0</td>
      <td>46.0</td>
      <td>262</td>
      <td>1956</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58490</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>WN</td>
      <td>MSP</td>
      <td>ATL</td>
      <td>525</td>
      <td>39.0</td>
      <td>124.0</td>
      <td>907</td>
      <td>855</td>
      <td>34.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58491</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>SFO</td>
      <td>BOI</td>
      <td>859</td>
      <td>5.0</td>
      <td>73.0</td>
      <td>522</td>
      <td>1146</td>
      <td>-1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>58492 rows × 14 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;AIRLINE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">MONTH</th>
      <th colspan="2" halign="left">DAY</th>
      <th>...</th>
      <th colspan="2" halign="left">DIVERTED</th>
      <th colspan="8" halign="left">CANCELLED</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>...</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>8900.0</td>
      <td>6.661461</td>
      <td>3.386332</td>
      <td>1.0</td>
      <td>4.00</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>8900.0</td>
      <td>15.570562</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>8900.0</td>
      <td>0.017303</td>
      <td>0.130407</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>768.0</td>
      <td>6.197917</td>
      <td>3.343428</td>
      <td>1.0</td>
      <td>3.75</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>768.0</td>
      <td>15.247396</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>768.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>543.0</td>
      <td>6.368324</td>
      <td>3.380085</td>
      <td>1.0</td>
      <td>4.00</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>543.0</td>
      <td>15.788214</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>543.0</td>
      <td>0.001842</td>
      <td>0.042914</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>10601.0</td>
      <td>6.277332</td>
      <td>3.340809</td>
      <td>1.0</td>
      <td>3.00</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>10601.0</td>
      <td>15.721158</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10601.0</td>
      <td>0.003585</td>
      <td>0.059767</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>5858.0</td>
      <td>6.003926</td>
      <td>3.318475</td>
      <td>1.0</td>
      <td>3.00</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>12.0</td>
      <td>5858.0</td>
      <td>15.866166</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5858.0</td>
      <td>0.024923</td>
      <td>0.155904</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>6588.0</td>
      <td>6.134791</td>
      <td>3.331999</td>
      <td>1.0</td>
      <td>3.00</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>6588.0</td>
      <td>15.651943</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>6588.0</td>
      <td>0.021554</td>
      <td>0.145234</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>7792.0</td>
      <td>6.322510</td>
      <td>3.326315</td>
      <td>1.0</td>
      <td>4.00</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>7792.0</td>
      <td>15.697510</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>7792.0</td>
      <td>0.011935</td>
      <td>0.108602</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>US</th>
      <td>1615.0</td>
      <td>3.628483</td>
      <td>1.714630</td>
      <td>1.0</td>
      <td>2.00</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>1615.0</td>
      <td>16.079876</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1615.0</td>
      <td>0.013003</td>
      <td>0.113322</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>993.0</td>
      <td>6.336354</td>
      <td>3.439813</td>
      <td>1.0</td>
      <td>4.00</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>993.0</td>
      <td>15.518630</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>993.0</td>
      <td>0.006042</td>
      <td>0.077536</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>8418.0</td>
      <td>6.298646</td>
      <td>3.373491</td>
      <td>1.0</td>
      <td>3.00</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>8418.0</td>
      <td>15.746971</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>8418.0</td>
      <td>0.011048</td>
      <td>0.104532</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>14 rows × 88 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;AIRLINE&#39;</span><span class="p">)[</span><span class="s1">&#39;DEP_DELAY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AIRLINE
AA    11.274057
AS     1.808594
B6    14.287823
DL     7.242450
EV     9.092625
        ...    
OO     9.662279
UA    16.210485
US     4.361355
VX     8.918946
WN    12.639366
Name: DEP_DELAY, Length: 14, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;AIRLINE&#39;</span><span class="p">,</span> <span class="s1">&#39;WEEKDAY&#39;</span><span class="p">])[[</span><span class="s1">&#39;CANCELLED&#39;</span><span class="p">,</span> <span class="s1">&#39;DIVERTED&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">CANCELLED</th>
      <th colspan="3" halign="left">DIVERTED</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>std</th>
      <th>sum</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>WEEKDAY</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>1</th>
      <td>41</td>
      <td>0.032106</td>
      <td>0.176352</td>
      <td>6</td>
      <td>0.004699</td>
      <td>0.068411</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>0.007341</td>
      <td>0.085399</td>
      <td>2</td>
      <td>0.001631</td>
      <td>0.040373</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>0.011949</td>
      <td>0.108698</td>
      <td>2</td>
      <td>0.001494</td>
      <td>0.038633</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0.015004</td>
      <td>0.121613</td>
      <td>5</td>
      <td>0.003751</td>
      <td>0.061153</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>0.014151</td>
      <td>0.118160</td>
      <td>1</td>
      <td>0.000786</td>
      <td>0.028039</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>3</th>
      <td>18</td>
      <td>0.014118</td>
      <td>0.118022</td>
      <td>2</td>
      <td>0.001569</td>
      <td>0.039590</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.007911</td>
      <td>0.088629</td>
      <td>4</td>
      <td>0.003165</td>
      <td>0.056188</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.005828</td>
      <td>0.076153</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10</td>
      <td>0.010132</td>
      <td>0.100196</td>
      <td>3</td>
      <td>0.003040</td>
      <td>0.055076</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>0.006066</td>
      <td>0.077681</td>
      <td>3</td>
      <td>0.002600</td>
      <td>0.050943</td>
    </tr>
  </tbody>
</table>
<p>98 rows × 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;AIRLINE&#39;</span><span class="p">])[[</span><span class="s1">&#39;AIRLINE&#39;</span><span class="p">,</span><span class="s1">&#39;CANCELLED&#39;</span><span class="p">,</span> <span class="s1">&#39;DEP_DELAY&#39;</span><span class="p">]]</span>\
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;AIRLINE&#39;</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;CANCELLED&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">],</span> <span class="s1">&#39;DEP_DELAY&#39;</span><span class="p">:[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">]})</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;count&#39;</span><span class="p">:</span><span class="s1">&#39;Total Flights&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span><span class="s1">&#39;Total Cancelled&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">:</span><span class="s1">&#39;Standard Deviation&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span><span class="s1">&#39;Average Delay&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>AIRLINE</th>
      <th>CANCELLED</th>
      <th colspan="2" halign="left">DEP_DELAY</th>
    </tr>
    <tr>
      <th></th>
      <th>Total Flights</th>
      <th>Total Cancelled</th>
      <th>Average Delay</th>
      <th>Standard Deviation</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>8900</td>
      <td>154</td>
      <td>11.274057</td>
      <td>40.787806</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>768</td>
      <td>0</td>
      <td>1.808594</td>
      <td>29.543702</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>543</td>
      <td>1</td>
      <td>14.287823</td>
      <td>36.863416</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>10601</td>
      <td>38</td>
      <td>7.242450</td>
      <td>29.759377</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>5858</td>
      <td>146</td>
      <td>9.092625</td>
      <td>34.582917</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>6588</td>
      <td>142</td>
      <td>9.662279</td>
      <td>33.413767</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>7792</td>
      <td>93</td>
      <td>16.210485</td>
      <td>44.834336</td>
    </tr>
    <tr>
      <th>US</th>
      <td>1615</td>
      <td>21</td>
      <td>4.361355</td>
      <td>24.550930</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>993</td>
      <td>6</td>
      <td>8.918946</td>
      <td>31.782085</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>8418</td>
      <td>93</td>
      <td>12.639366</td>
      <td>30.506549</td>
    </tr>
  </tbody>
</table>
<p>14 rows × 4 columns</p>
</div></div></div>
</div>
<div class="section" id="named-aggregation">
<h4>Named Aggregation<a class="headerlink" href="#named-aggregation" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;AIRLINE&#39;</span><span class="p">])</span>\
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span>
         <span class="o">**</span><span class="p">{</span>
             <span class="s2">&quot;Total Flights&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;AIRLINE&#39;</span><span class="p">,</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">),</span>
             <span class="s2">&quot;Total Cancelled&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;CANCELLED&#39;</span><span class="p">,</span><span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">),</span>
             <span class="s2">&quot;Average_Delay&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;DEP_DELAY&#39;</span><span class="p">,</span><span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">),</span>
             <span class="s2">&quot;Std Dev on Departure Delay&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;DEP_DELAY&#39;</span><span class="p">,</span><span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">),</span>
             <span class="s2">&quot;Funny Val&quot;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;DEP_DELAY&#39;</span><span class="p">,</span><span class="n">aggfunc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Can supply lambda as well.</span>
         <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Total Flights</th>
      <th>Total Cancelled</th>
      <th>Average_Delay</th>
      <th>Std Dev on Departure Delay</th>
      <th>Funny Val</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>8900</td>
      <td>154</td>
      <td>11.274057</td>
      <td>40.787806</td>
      <td>42.785475</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>768</td>
      <td>0</td>
      <td>1.808594</td>
      <td>29.543702</td>
      <td>31.524462</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>543</td>
      <td>1</td>
      <td>14.287823</td>
      <td>36.863416</td>
      <td>38.829394</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>10601</td>
      <td>38</td>
      <td>7.242450</td>
      <td>29.759377</td>
      <td>31.757969</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>5858</td>
      <td>146</td>
      <td>9.092625</td>
      <td>34.582917</td>
      <td>36.579895</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>6588</td>
      <td>142</td>
      <td>9.662279</td>
      <td>33.413767</td>
      <td>35.411180</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>7792</td>
      <td>93</td>
      <td>16.210485</td>
      <td>44.834336</td>
      <td>46.831427</td>
    </tr>
    <tr>
      <th>US</th>
      <td>1615</td>
      <td>21</td>
      <td>4.361355</td>
      <td>24.550930</td>
      <td>26.543228</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>993</td>
      <td>6</td>
      <td>8.918946</td>
      <td>31.782085</td>
      <td>33.765981</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>8418</td>
      <td>93</td>
      <td>12.639366</td>
      <td>30.506549</td>
      <td>32.504717</td>
    </tr>
  </tbody>
</table>
<p>14 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>SLC</td>
      <td>1625</td>
      <td>58.0</td>
      <td>94.0</td>
      <td>590</td>
      <td>1905</td>
      <td>65.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>UA</td>
      <td>DEN</td>
      <td>IAD</td>
      <td>823</td>
      <td>7.0</td>
      <td>154.0</td>
      <td>1452</td>
      <td>1333</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>VPS</td>
      <td>1305</td>
      <td>36.0</td>
      <td>85.0</td>
      <td>641</td>
      <td>1453</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>DCA</td>
      <td>1555</td>
      <td>7.0</td>
      <td>126.0</td>
      <td>1192</td>
      <td>1935</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>MCI</td>
      <td>1720</td>
      <td>48.0</td>
      <td>166.0</td>
      <td>1363</td>
      <td>2225</td>
      <td>39.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58487</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>AA</td>
      <td>SFO</td>
      <td>DFW</td>
      <td>515</td>
      <td>5.0</td>
      <td>166.0</td>
      <td>1464</td>
      <td>1045</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58488</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>F9</td>
      <td>LAS</td>
      <td>SFO</td>
      <td>1910</td>
      <td>13.0</td>
      <td>71.0</td>
      <td>414</td>
      <td>2050</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58489</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>SFO</td>
      <td>SBA</td>
      <td>1846</td>
      <td>-6.0</td>
      <td>46.0</td>
      <td>262</td>
      <td>1956</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58490</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>WN</td>
      <td>MSP</td>
      <td>ATL</td>
      <td>525</td>
      <td>39.0</td>
      <td>124.0</td>
      <td>907</td>
      <td>855</td>
      <td>34.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58491</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>OO</td>
      <td>SFO</td>
      <td>BOI</td>
      <td>859</td>
      <td>5.0</td>
      <td>73.0</td>
      <td>522</td>
      <td>1146</td>
      <td>-1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>58492 rows × 14 columns</p>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="timeseries">
<h2>TimeSeries<a class="headerlink" href="#timeseries" title="Permalink to this headline">¶</a></h2>
<p>Working with dates and times is a complex topic, only a small subset of functionality is covered here.</p>
<p>While working with pandas timeseries you can use the following time related concepts</p>
<ul class="simple">
<li><p>Date time - A specific date and time with timezone support</p></li>
<li><p>Time deltas - absolute time duration</p></li>
<li><p>Time Spans -  A span of time defined by a point in time and its associated frequency.</p></li>
<li><p>Date Offsets - A relative time duration that respects calendar arithmetic.</p></li>
</ul>
<p>For details on the methods refer to the following <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/timeseries.html#overview">link</a></p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pd.date_range('2020-01-01',</span> <span class="pre">periods=10,freq='H')</span></code></p></td>
<td><p>Creating dates</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pd.Timedelta</span></code></p></td>
<td><p>Used for arithmetic of date and time</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">df['col'].astype('datetime64')</span></code></p></td>
<td><p>Convert to datetype. For timezone use <code class="docutils literal notranslate"><span class="pre">'datetime64[ns,</span> <span class="pre">US/Eastern]'</span></code> Supports from nanosec to weeks.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pd.to_datetime(df['col'])</span></code></p></td>
<td><p>Converts to datetime from various formats.</p></td>
</tr>
</tbody>
</table>
<p>TimeDelta for calculations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">day1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">)</span>
<span class="n">day1</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2020-01-02 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>Convert objects to datetime</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emp</span><span class="p">[</span><span class="s1">&#39;hire_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">emp</span><span class="o">.</span><span class="n">hire_date</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64&#39;</span><span class="p">)</span>
<span class="n">emp</span><span class="p">[</span><span class="s1">&#39;job_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">emp</span><span class="o">.</span><span class="n">job_date</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

<div class="section">
   
</div>

              </div>
              
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'G-EKRVF1S5Y8', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2021 - Rajat Sethi.<br/>
    </p>
  </div>
</footer>
  </body>
</html>