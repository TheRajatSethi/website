{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Pandas cheatsheet"
   ]
  },
  {
   "source": [
    "```{post} 2021-02-25\n",
    ":tags: data science, pandas\n",
    ":author: Rajat Sethi\n",
    "```"
   ],
   "cell_type": "markdown",
   "metadata": {}
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This cheatsheet lists out important and most used pandas functionality."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".dataframe th {\n",
       "    font-size: 10.5px;\n",
       "    color: #3b3b3b;\n",
       "}\n",
       ".dataframe td {\n",
       "    font-size: 10.5px;\n",
       "    color: #3b3b3b;\n",
       "}\n",
       "</style>\n"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%%html\n",
    "<style>\n",
    ".dataframe th {\n",
    "    font-size: 10.5px;\n",
    "    color: #3b3b3b;\n",
    "}\n",
    ".dataframe td {\n",
    "    font-size: 10.5px;\n",
    "    color: #3b3b3b;\n",
    "}\n",
    "</style>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Setting optimal options for cheatsheet.\n",
    "pd.set_option('display.max_rows', 10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Input & Output"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Pandas input and output functions."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```{list-table}\n",
    ":header-rows: 1\n",
    "\n",
    "* - Function\n",
    "  - Description\n",
    "* - `pd.read_csv()`\n",
    "  - reads data from csv file\n",
    "* - `pd.to_csv()`\n",
    "  - writes data to csv file\n",
    "* - `pd.read_sql`\n",
    "  - reads from sql\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Snippets"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Reading from mysql**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```python\n",
    "from sqlalchemy import create_engine\n",
    "import pymysql\n",
    "\n",
    "db_connection_str = 'mysql+pymysql://user_name:password@mysqlhost/database_name'\n",
    "db_connection = create_engine(db_connection_str)\n",
    "\n",
    "df = pd.read_sql('SELECT * FROM customers', con=db_connection)\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Selecting & Indexing"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```{csv-table}\n",
    ":header-rows: 1\n",
    ":delim: ;\n",
    "\n",
    "Code; Description\n",
    "``df['col']``; Selects a single column\n",
    "``df[['col1', 'col2']]``; Selects multiple columns. Pass in a list of columns.\n",
    "``df.loc[index]``; selects single row\n",
    "``df.loc[[index1,index2], [col1, col2]]``; selects specified rows and columns\n",
    "``df.loc[start_index:end_index, start_col:end_col]``; slices rows and slices columns (end value is included unlike Python). Standard slicing is supported e.g. ``dfl.loc['index':,::-1]``\n",
    "``df.sort_index()``; sorts row based on index\n",
    "``df.iloc[]``; selects by position not label\n",
    "``df.index[position]``; gives index for a position\n",
    "``df.index[[pos1, pos2, .., posn]]``; gives index for requested positions\n",
    "``df.set_index[[col, col]]``; Ability to set single or multi-index.\n",
    "``df.sample()``; gives back a random sample. You can pass in the count or the fraction.\n",
    "``df.columns.get_loc('col_name')``; returns location for a particular column\n",
    "``df.columns.get_indexer(['col_name', 'col_name'])``; returns location for a particular columns\n",
    "``| & ~``; used for boolean indexing\n",
    "``series.isin(iterable)``; returns True if value is in iterable\n",
    "``series/df.where(filter_condition, default value)``; returns the same shape as original df and not a subset like boolean indexing\n",
    "``df.query('expression')``; querys based on string experssion\n",
    "``df.duplicated([col, col])``; duplicacy checks\n",
    "``df.drop_duplicates([col, col], keep='first')``; drop duplicate where keep can be last or first or False\n",
    "``series.get(index, default=___)``; dict like get method\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Snippets"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Using conditionals on a single row to filter out columns. The below example would work on row which has all integers**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>A</th>\n",
       "      <th>B</th>\n",
       "      <th>C</th>\n",
       "      <th>D</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>a</th>\n",
       "      <td>0.786073</td>\n",
       "      <td>0.241026</td>\n",
       "      <td>1.836268</td>\n",
       "      <td>1.130302</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>b</th>\n",
       "      <td>0.440493</td>\n",
       "      <td>1.617552</td>\n",
       "      <td>-0.068282</td>\n",
       "      <td>-0.022670</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>c</th>\n",
       "      <td>-1.559774</td>\n",
       "      <td>0.603044</td>\n",
       "      <td>-1.606989</td>\n",
       "      <td>0.814513</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>d</th>\n",
       "      <td>-0.091140</td>\n",
       "      <td>-0.616634</td>\n",
       "      <td>-0.000725</td>\n",
       "      <td>0.047443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>e</th>\n",
       "      <td>0.274607</td>\n",
       "      <td>0.033709</td>\n",
       "      <td>-0.676457</td>\n",
       "      <td>-0.480869</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f</th>\n",
       "      <td>0.273721</td>\n",
       "      <td>-0.947775</td>\n",
       "      <td>0.773054</td>\n",
       "      <td>1.152777</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          A         B         C         D\n",
       "a  0.786073  0.241026  1.836268  1.130302\n",
       "b  0.440493  1.617552 -0.068282 -0.022670\n",
       "c -1.559774  0.603044 -1.606989  0.814513\n",
       "d -0.091140 -0.616634 -0.000725  0.047443\n",
       "e  0.274607  0.033709 -0.676457 -0.480869\n",
       "f  0.273721 -0.947775  0.773054  1.152777"
      ]
     },
     "execution_count": 104,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "df1 = pd.DataFrame(np.random.randn(6,4), index=list('abcdef'), columns=list('ABCD'))\n",
    "\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>A</th>\n",
       "      <th>B</th>\n",
       "      <th>C</th>\n",
       "      <th>D</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>a</th>\n",
       "      <td>0.786073</td>\n",
       "      <td>0.241026</td>\n",
       "      <td>1.836268</td>\n",
       "      <td>1.130302</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>b</th>\n",
       "      <td>0.440493</td>\n",
       "      <td>1.617552</td>\n",
       "      <td>-0.068282</td>\n",
       "      <td>-0.022670</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>c</th>\n",
       "      <td>-1.559774</td>\n",
       "      <td>0.603044</td>\n",
       "      <td>-1.606989</td>\n",
       "      <td>0.814513</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>d</th>\n",
       "      <td>-0.091140</td>\n",
       "      <td>-0.616634</td>\n",
       "      <td>-0.000725</td>\n",
       "      <td>0.047443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>e</th>\n",
       "      <td>0.274607</td>\n",
       "      <td>0.033709</td>\n",
       "      <td>-0.676457</td>\n",
       "      <td>-0.480869</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f</th>\n",
       "      <td>0.273721</td>\n",
       "      <td>-0.947775</td>\n",
       "      <td>0.773054</td>\n",
       "      <td>1.152777</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          A         B         C         D\n",
       "a  0.786073  0.241026  1.836268  1.130302\n",
       "b  0.440493  1.617552 -0.068282 -0.022670\n",
       "c -1.559774  0.603044 -1.606989  0.814513\n",
       "d -0.091140 -0.616634 -0.000725  0.047443\n",
       "e  0.274607  0.033709 -0.676457 -0.480869\n",
       "f  0.273721 -0.947775  0.773054  1.152777"
      ]
     },
     "execution_count": 105,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Creates a mask for a single row to filter out the cols ==> df1.loc['a'] > 0\n",
    "\n",
    "df1.loc[:, df1.loc['a'] > 0]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Using functions's for selection\n",
    "\n",
    "The function should take one argument.\n",
    "\n",
    "Selecting rows from DataFrame where the column *base_salary* has value greater than 50K."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>gender</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>ASSISTANT DIRECTOR (EX LVL)</td>\n",
       "      <td>Municipal Courts Department</td>\n",
       "      <td>121862.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2006-06-12</td>\n",
       "      <td>2012-10-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>LIBRARY ASSISTANT</td>\n",
       "      <td>Library</td>\n",
       "      <td>26125.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2000-07-19</td>\n",
       "      <td>2010-09-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>45279.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2015-02-03</td>\n",
       "      <td>2015-02-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>ENGINEER/OPERATOR</td>\n",
       "      <td>Houston Fire Department (HFD)</td>\n",
       "      <td>63166.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1982-02-08</td>\n",
       "      <td>1991-05-25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>ELECTRICIAN</td>\n",
       "      <td>General Services Department</td>\n",
       "      <td>56347.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1989-06-19</td>\n",
       "      <td>1994-10-22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19960</th>\n",
       "      <td>POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>43443.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2014-06-09</td>\n",
       "      <td>2015-06-09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19970</th>\n",
       "      <td>COMMUNICATIONS CAPTAIN</td>\n",
       "      <td>Houston Fire Department (HFD)</td>\n",
       "      <td>66523.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2003-09-02</td>\n",
       "      <td>2013-10-06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19980</th>\n",
       "      <td>POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>43443.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2014-10-13</td>\n",
       "      <td>2015-10-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19990</th>\n",
       "      <td>POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>55461.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2009-01-20</td>\n",
       "      <td>2011-07-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20000</th>\n",
       "      <td>FIRE FIGHTER</td>\n",
       "      <td>Houston Fire Department (HFD)</td>\n",
       "      <td>51194.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2009-01-12</td>\n",
       "      <td>2010-07-12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2000 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                        position_title                     department  \\\n",
       "unique_id                                                               \n",
       "10         ASSISTANT DIRECTOR (EX LVL)    Municipal Courts Department   \n",
       "20                   LIBRARY ASSISTANT                        Library   \n",
       "30                      POLICE OFFICER  Houston Police Department-HPD   \n",
       "40                   ENGINEER/OPERATOR  Houston Fire Department (HFD)   \n",
       "50                         ELECTRICIAN    General Services Department   \n",
       "...                                ...                            ...   \n",
       "19960                   POLICE OFFICER  Houston Police Department-HPD   \n",
       "19970           COMMUNICATIONS CAPTAIN  Houston Fire Department (HFD)   \n",
       "19980                   POLICE OFFICER  Houston Police Department-HPD   \n",
       "19990                   POLICE OFFICER  Houston Police Department-HPD   \n",
       "20000                     FIRE FIGHTER  Houston Fire Department (HFD)   \n",
       "\n",
       "           base_salary  gender employment_status   hire_date    job_date  \n",
       "unique_id                                                                 \n",
       "10            121862.0  Female            Active  2006-06-12  2012-10-13  \n",
       "20             26125.0  Female            Active  2000-07-19  2010-09-18  \n",
       "30             45279.0    Male            Active  2015-02-03  2015-02-03  \n",
       "40             63166.0    Male            Active  1982-02-08  1991-05-25  \n",
       "50             56347.0    Male            Active  1989-06-19  1994-10-22  \n",
       "...                ...     ...               ...         ...         ...  \n",
       "19960          43443.0    Male            Active  2014-06-09  2015-06-09  \n",
       "19970          66523.0    Male            Active  2003-09-02  2013-10-06  \n",
       "19980          43443.0    Male            Active  2014-10-13  2015-10-13  \n",
       "19990          55461.0    Male            Active  2009-01-20  2011-07-02  \n",
       "20000          51194.0    Male            Active  2009-01-12  2010-07-12  \n",
       "\n",
       "[2000 rows x 7 columns]"
      ]
     },
     "execution_count": 106,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "emp = pd.read_csv('data/employee.csv', index_col='unique_id')\n",
    "emp"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>gender</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>120</th>\n",
       "      <td>CHIEF PHYSICIAN,MD</td>\n",
       "      <td>Health &amp; Human Services</td>\n",
       "      <td>180416.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1987-05-22</td>\n",
       "      <td>1999-08-28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>440</th>\n",
       "      <td>ASSOCIATE EMS PHYSICIAN DIRECTOR</td>\n",
       "      <td>Houston Fire Department (HFD)</td>\n",
       "      <td>165216.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2013-08-31</td>\n",
       "      <td>2013-08-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1790</th>\n",
       "      <td>ASSOCIATE EMS PHYSICIAN DIRECTOR,MD</td>\n",
       "      <td>Houston Fire Department (HFD)</td>\n",
       "      <td>210588.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2001-09-05</td>\n",
       "      <td>2003-05-10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5940</th>\n",
       "      <td>CITY ATTORNEY</td>\n",
       "      <td>Legal Department</td>\n",
       "      <td>275000.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2016-05-02</td>\n",
       "      <td>2016-05-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6060</th>\n",
       "      <td>DEPUTY DIRECTOR (EXECUTIVE LEVEL)</td>\n",
       "      <td>Houston Airport System (HAS)</td>\n",
       "      <td>150416.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2013-06-10</td>\n",
       "      <td>2013-06-10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7200</th>\n",
       "      <td>DEPUTY DIRECTOR (EXECUTIVE LEVEL)</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>163228.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1977-07-20</td>\n",
       "      <td>1998-08-08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7430</th>\n",
       "      <td>SENIOR ASSISTANT CITY ATTORNEY II</td>\n",
       "      <td>Legal Department</td>\n",
       "      <td>150416.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2012-06-11</td>\n",
       "      <td>2013-07-06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7680</th>\n",
       "      <td>DEPUTY DIRECTOR-FINANCE &amp; ADMINISTRATION</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>199596.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2007-02-01</td>\n",
       "      <td>2007-02-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8560</th>\n",
       "      <td>DEPUTY DIRECTOR-AVIATION (EX LVL)</td>\n",
       "      <td>Houston Airport System (HAS)</td>\n",
       "      <td>186192.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2013-08-22</td>\n",
       "      <td>2014-08-16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12330</th>\n",
       "      <td>DEPUTY DIRECTOR-PUBLIC WORKS (EXECUTIVE</td>\n",
       "      <td>Public Works &amp; Engineering-PWE</td>\n",
       "      <td>178331.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>1991-02-12</td>\n",
       "      <td>2005-05-14</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     position_title  \\\n",
       "unique_id                                             \n",
       "120                              CHIEF PHYSICIAN,MD   \n",
       "440                ASSOCIATE EMS PHYSICIAN DIRECTOR   \n",
       "1790            ASSOCIATE EMS PHYSICIAN DIRECTOR,MD   \n",
       "5940                                  CITY ATTORNEY   \n",
       "6060              DEPUTY DIRECTOR (EXECUTIVE LEVEL)   \n",
       "7200              DEPUTY DIRECTOR (EXECUTIVE LEVEL)   \n",
       "7430              SENIOR ASSISTANT CITY ATTORNEY II   \n",
       "7680       DEPUTY DIRECTOR-FINANCE & ADMINISTRATION   \n",
       "8560              DEPUTY DIRECTOR-AVIATION (EX LVL)   \n",
       "12330       DEPUTY DIRECTOR-PUBLIC WORKS (EXECUTIVE   \n",
       "\n",
       "                               department  base_salary  gender  \\\n",
       "unique_id                                                        \n",
       "120               Health & Human Services     180416.0    Male   \n",
       "440         Houston Fire Department (HFD)     165216.0    Male   \n",
       "1790        Houston Fire Department (HFD)     210588.0    Male   \n",
       "5940                     Legal Department     275000.0    Male   \n",
       "6060         Houston Airport System (HAS)     150416.0  Female   \n",
       "7200        Houston Police Department-HPD     163228.0    Male   \n",
       "7430                     Legal Department     150416.0  Female   \n",
       "7680        Houston Police Department-HPD     199596.0    Male   \n",
       "8560         Houston Airport System (HAS)     186192.0    Male   \n",
       "12330      Public Works & Engineering-PWE     178331.0  Female   \n",
       "\n",
       "          employment_status   hire_date    job_date  \n",
       "unique_id                                            \n",
       "120                  Active  1987-05-22  1999-08-28  \n",
       "440                  Active  2013-08-31  2013-08-31  \n",
       "1790                 Active  2001-09-05  2003-05-10  \n",
       "5940                 Active  2016-05-02  2016-05-02  \n",
       "6060                 Active  2013-06-10  2013-06-10  \n",
       "7200                 Active  1977-07-20  1998-08-08  \n",
       "7430                 Active  2012-06-11  2013-07-06  \n",
       "7680                 Active  2007-02-01  2007-02-01  \n",
       "8560                 Active  2013-08-22  2014-08-16  \n",
       "12330                Active  1991-02-12  2005-05-14  "
      ]
     },
     "execution_count": 107,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emp.loc[lambda x: emp['base_salary'] > 150000]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Combine positional and label to select data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the below example `df.index[0:10:4]` provides the index for every 4th row from 0 to 10 position."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>base_salary</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Female</td>\n",
       "      <td>121862.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>Male</td>\n",
       "      <td>56347.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>Male</td>\n",
       "      <td>107962.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           gender  base_salary\n",
       "unique_id                     \n",
       "10         Female     121862.0\n",
       "50           Male      56347.0\n",
       "90           Male     107962.0"
      ]
     },
     "execution_count": 108,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emp.loc[emp.index[0:10:4], ['gender', 'base_salary']]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the below example ``df.columns.get_loc('base_salary')`` returns the integer position of the column base_salary."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "unique_id\n",
       "10    121862.0\n",
       "50     56347.0\n",
       "Name: base_salary, dtype: float64"
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " emp.iloc[[0,4], emp.columns.get_loc('base_salary') ]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the below example ``df.columns.get_indexer(['base_salary', 'gender' ])`` returns the integer position of the all specified columns."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>base_salary</th>\n",
       "      <th>gender</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>121862.0</td>\n",
       "      <td>Female</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>56347.0</td>\n",
       "      <td>Male</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           base_salary  gender\n",
       "unique_id                     \n",
       "10            121862.0  Female\n",
       "50             56347.0    Male"
      ]
     },
     "execution_count": 110,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emp.iloc[[0,4], emp.columns.get_indexer(['base_salary', 'gender' ])]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Boolean Indexing"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Tip : Use () to seperate the comparisons."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>gender</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>ASSISTANT DIRECTOR (EX LVL)</td>\n",
       "      <td>Municipal Courts Department</td>\n",
       "      <td>121862.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2006-06-12</td>\n",
       "      <td>2012-10-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>LIBRARY ASSISTANT</td>\n",
       "      <td>Library</td>\n",
       "      <td>26125.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2000-07-19</td>\n",
       "      <td>2010-09-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>DEPUTY ASSISTANT DIRECTOR (EXECUTIVE LEV</td>\n",
       "      <td>Public Works &amp; Engineering-PWE</td>\n",
       "      <td>107962.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1993-11-15</td>\n",
       "      <td>2013-01-05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>120</th>\n",
       "      <td>CHIEF PHYSICIAN,MD</td>\n",
       "      <td>Health &amp; Human Services</td>\n",
       "      <td>180416.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1987-05-22</td>\n",
       "      <td>1999-08-28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>360</th>\n",
       "      <td>DENTAL ASSISTANT</td>\n",
       "      <td>Health &amp; Human Services</td>\n",
       "      <td>34923.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>1982-04-05</td>\n",
       "      <td>1990-11-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19840</th>\n",
       "      <td>ADMINISTRATIVE SPECIALIST</td>\n",
       "      <td>Admn. &amp; Regulatory Affairs</td>\n",
       "      <td>55172.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2006-10-16</td>\n",
       "      <td>2006-10-16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19890</th>\n",
       "      <td>SENIOR ASSISTANT CITY ATTORNEY II</td>\n",
       "      <td>Legal Department</td>\n",
       "      <td>124115.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>2013-01-23</td>\n",
       "      <td>2013-03-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19910</th>\n",
       "      <td>BUILDING MAINTENANCE SUPERVISOR</td>\n",
       "      <td>Parks &amp; Recreation</td>\n",
       "      <td>30347.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>1995-10-14</td>\n",
       "      <td>2010-03-20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19920</th>\n",
       "      <td>MOBILITY SERVICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>44429.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2005-09-12</td>\n",
       "      <td>2007-06-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19950</th>\n",
       "      <td>POLICE CAPTAIN</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>104455.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1983-02-07</td>\n",
       "      <td>2004-07-08</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>639 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     position_title  \\\n",
       "unique_id                                             \n",
       "10                      ASSISTANT DIRECTOR (EX LVL)   \n",
       "20                                LIBRARY ASSISTANT   \n",
       "90         DEPUTY ASSISTANT DIRECTOR (EXECUTIVE LEV   \n",
       "120                              CHIEF PHYSICIAN,MD   \n",
       "360                                DENTAL ASSISTANT   \n",
       "...                                             ...   \n",
       "19840                     ADMINISTRATIVE SPECIALIST   \n",
       "19890             SENIOR ASSISTANT CITY ATTORNEY II   \n",
       "19910               BUILDING MAINTENANCE SUPERVISOR   \n",
       "19920                      MOBILITY SERVICE OFFICER   \n",
       "19950                                POLICE CAPTAIN   \n",
       "\n",
       "                               department  base_salary  gender  \\\n",
       "unique_id                                                        \n",
       "10            Municipal Courts Department     121862.0  Female   \n",
       "20                                Library      26125.0  Female   \n",
       "90         Public Works & Engineering-PWE     107962.0    Male   \n",
       "120               Health & Human Services     180416.0    Male   \n",
       "360               Health & Human Services      34923.0  Female   \n",
       "...                                   ...          ...     ...   \n",
       "19840          Admn. & Regulatory Affairs      55172.0  Female   \n",
       "19890                    Legal Department     124115.0    Male   \n",
       "19910                  Parks & Recreation      30347.0  Female   \n",
       "19920       Houston Police Department-HPD      44429.0  Female   \n",
       "19950       Houston Police Department-HPD     104455.0    Male   \n",
       "\n",
       "          employment_status   hire_date    job_date  \n",
       "unique_id                                            \n",
       "10                   Active  2006-06-12  2012-10-13  \n",
       "20                   Active  2000-07-19  2010-09-18  \n",
       "90                   Active  1993-11-15  2013-01-05  \n",
       "120                  Active  1987-05-22  1999-08-28  \n",
       "360                  Active  1982-04-05  1990-11-03  \n",
       "...                     ...         ...         ...  \n",
       "19840                Active  2006-10-16  2006-10-16  \n",
       "19890                Active  2013-01-23  2013-03-02  \n",
       "19910                Active  1995-10-14  2010-03-20  \n",
       "19920                Active  2005-09-12  2007-06-02  \n",
       "19950                Active  1983-02-07  2004-07-08  \n",
       "\n",
       "[639 rows x 7 columns]"
      ]
     },
     "execution_count": 111,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mask = (emp['base_salary'] > 100000) | (emp['gender'] == 'Female') & (emp['employment_status'] == 'Active')\n",
    "emp[mask]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "A little bit more complicated example."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>gender</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>SENIOR POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>66614.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1984-11-26</td>\n",
       "      <td>2005-03-26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>SENIOR POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>66614.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1992-02-17</td>\n",
       "      <td>2007-07-28</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  position_title                     department  base_salary  \\\n",
       "unique_id                                                                      \n",
       "60         SENIOR POLICE OFFICER  Houston Police Department-HPD      66614.0   \n",
       "200        SENIOR POLICE OFFICER  Houston Police Department-HPD      66614.0   \n",
       "\n",
       "          gender employment_status   hire_date    job_date  \n",
       "unique_id                                                   \n",
       "60          Male            Active  1984-11-26  2005-03-26  \n",
       "200         Male            Active  1992-02-17  2007-07-28  "
      ]
     },
     "execution_count": 112,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "occupations = ['POLICE OFFICER', 'SENIOR POLICE OFFICER']\n",
    "mask = ((emp['position_title'].map(lambda x: x in occupations)) & (emp['base_salary'] > 50000))\n",
    "emp[mask].head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>gender</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>SENIOR POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>66614.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1984-11-26</td>\n",
       "      <td>2005-03-26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>SENIOR POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>66614.0</td>\n",
       "      <td>Male</td>\n",
       "      <td>Active</td>\n",
       "      <td>1992-02-17</td>\n",
       "      <td>2007-07-28</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  position_title                     department  base_salary  \\\n",
       "unique_id                                                                      \n",
       "60         SENIOR POLICE OFFICER  Houston Police Department-HPD      66614.0   \n",
       "200        SENIOR POLICE OFFICER  Houston Police Department-HPD      66614.0   \n",
       "\n",
       "          gender employment_status   hire_date    job_date  \n",
       "unique_id                                                   \n",
       "60          Male            Active  1984-11-26  2005-03-26  \n",
       "200         Male            Active  1992-02-17  2007-07-28  "
      ]
     },
     "execution_count": 113,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Write above using isin\n",
    "\n",
    "mask = ((emp['position_title'].isin(occupations)) & (emp['base_salary'] > 50000))\n",
    "emp[mask].head(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Where"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>gender</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>ASSISTANT DIRECTOR (EX LVL)</td>\n",
       "      <td>Municipal Courts Department</td>\n",
       "      <td>121862</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2006-06-12</td>\n",
       "      <td>2012-10-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>LIBRARY ASSISTANT</td>\n",
       "      <td>Library</td>\n",
       "      <td>26125</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2000-07-19</td>\n",
       "      <td>2010-09-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19960</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19970</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19980</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19990</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20000</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2000 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                        position_title                   department  \\\n",
       "unique_id                                                             \n",
       "10         ASSISTANT DIRECTOR (EX LVL)  Municipal Courts Department   \n",
       "20                   LIBRARY ASSISTANT                      Library   \n",
       "30                               False                        False   \n",
       "40                               False                        False   \n",
       "50                               False                        False   \n",
       "...                                ...                          ...   \n",
       "19960                            False                        False   \n",
       "19970                            False                        False   \n",
       "19980                            False                        False   \n",
       "19990                            False                        False   \n",
       "20000                            False                        False   \n",
       "\n",
       "          base_salary  gender employment_status   hire_date    job_date  \n",
       "unique_id                                                                \n",
       "10             121862  Female            Active  2006-06-12  2012-10-13  \n",
       "20              26125  Female            Active  2000-07-19  2010-09-18  \n",
       "30              False   False             False       False       False  \n",
       "40              False   False             False       False       False  \n",
       "50              False   False             False       False       False  \n",
       "...               ...     ...               ...         ...         ...  \n",
       "19960           False   False             False       False       False  \n",
       "19970           False   False             False       False       False  \n",
       "19980           False   False             False       False       False  \n",
       "19990           False   False             False       False       False  \n",
       "20000           False   False             False       False       False  \n",
       "\n",
       "[2000 rows x 7 columns]"
      ]
     },
     "execution_count": 114,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emp.where(emp['gender'] == 'Female', False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>gender</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>ASSISTANT DIRECTOR (EX LVL)</td>\n",
       "      <td>Municipal Courts Department</td>\n",
       "      <td>121862.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2006-06-12</td>\n",
       "      <td>2012-10-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>670</th>\n",
       "      <td>PUBLIC HEALTH DENTIST,DDS</td>\n",
       "      <td>Health &amp; Human Services</td>\n",
       "      <td>100791.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2015-12-28</td>\n",
       "      <td>2015-12-28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2380</th>\n",
       "      <td>ASSISTANT DIRECTOR (EXECUTIVE LEVEL)</td>\n",
       "      <td>Admn. &amp; Regulatory Affairs</td>\n",
       "      <td>130416.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2002-05-24</td>\n",
       "      <td>2013-07-20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3670</th>\n",
       "      <td>DEPUTY ASSISTANT DIRECTOR (EXECUTIVE LEV</td>\n",
       "      <td>Mayor's Office</td>\n",
       "      <td>110000.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2014-05-13</td>\n",
       "      <td>2014-05-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5230</th>\n",
       "      <td>DEPUTY ASSISTANT DIRECTOR (EX LVL)</td>\n",
       "      <td>Houston Airport System (HAS)</td>\n",
       "      <td>110686.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2011-11-07</td>\n",
       "      <td>2011-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15610</th>\n",
       "      <td>SENIOR ASSISTANT CITY ATTORNEY II</td>\n",
       "      <td>Legal Department</td>\n",
       "      <td>122220.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2005-09-12</td>\n",
       "      <td>2012-07-21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17790</th>\n",
       "      <td>DIVISION MANAGER</td>\n",
       "      <td>Human Resources Dept.</td>\n",
       "      <td>110547.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2000-01-29</td>\n",
       "      <td>2010-12-25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17850</th>\n",
       "      <td>JUDGE OF MUNICIPAL COURTS</td>\n",
       "      <td>Municipal Courts Department</td>\n",
       "      <td>117176.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>1999-09-25</td>\n",
       "      <td>2010-11-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19440</th>\n",
       "      <td>ASSISTANT DIRECTOR (EXECUTIVE LEVEL)</td>\n",
       "      <td>Houston Airport System (HAS)</td>\n",
       "      <td>128606.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>1993-02-22</td>\n",
       "      <td>2004-09-04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19470</th>\n",
       "      <td>SENIOR ASSISTANT CITY ATTORNEY II</td>\n",
       "      <td>Legal Department</td>\n",
       "      <td>117831.0</td>\n",
       "      <td>Female</td>\n",
       "      <td>Active</td>\n",
       "      <td>2005-07-18</td>\n",
       "      <td>2012-07-21</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>21 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     position_title  \\\n",
       "unique_id                                             \n",
       "10                      ASSISTANT DIRECTOR (EX LVL)   \n",
       "670                       PUBLIC HEALTH DENTIST,DDS   \n",
       "2380           ASSISTANT DIRECTOR (EXECUTIVE LEVEL)   \n",
       "3670       DEPUTY ASSISTANT DIRECTOR (EXECUTIVE LEV   \n",
       "5230             DEPUTY ASSISTANT DIRECTOR (EX LVL)   \n",
       "...                                             ...   \n",
       "15610             SENIOR ASSISTANT CITY ATTORNEY II   \n",
       "17790                              DIVISION MANAGER   \n",
       "17850                     JUDGE OF MUNICIPAL COURTS   \n",
       "19440          ASSISTANT DIRECTOR (EXECUTIVE LEVEL)   \n",
       "19470             SENIOR ASSISTANT CITY ATTORNEY II   \n",
       "\n",
       "                             department  base_salary  gender  \\\n",
       "unique_id                                                      \n",
       "10          Municipal Courts Department     121862.0  Female   \n",
       "670             Health & Human Services     100791.0  Female   \n",
       "2380         Admn. & Regulatory Affairs     130416.0  Female   \n",
       "3670                     Mayor's Office     110000.0  Female   \n",
       "5230       Houston Airport System (HAS)     110686.0  Female   \n",
       "...                                 ...          ...     ...   \n",
       "15610                  Legal Department     122220.0  Female   \n",
       "17790             Human Resources Dept.     110547.0  Female   \n",
       "17850       Municipal Courts Department     117176.0  Female   \n",
       "19440      Houston Airport System (HAS)     128606.0  Female   \n",
       "19470                  Legal Department     117831.0  Female   \n",
       "\n",
       "          employment_status   hire_date    job_date  \n",
       "unique_id                                            \n",
       "10                   Active  2006-06-12  2012-10-13  \n",
       "670                  Active  2015-12-28  2015-12-28  \n",
       "2380                 Active  2002-05-24  2013-07-20  \n",
       "3670                 Active  2014-05-13  2014-05-13  \n",
       "5230                 Active  2011-11-07  2011-11-07  \n",
       "...                     ...         ...         ...  \n",
       "15610                Active  2005-09-12  2012-07-21  \n",
       "17790                Active  2000-01-29  2010-12-25  \n",
       "17850                Active  1999-09-25  2010-11-13  \n",
       "19440                Active  1993-02-22  2004-09-04  \n",
       "19470                Active  2005-07-18  2012-07-21  \n",
       "\n",
       "[21 rows x 7 columns]"
      ]
     },
     "execution_count": 115,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " emp.query('base_salary > 100000 and employment_status == \"Active\" and gender == \"Female\"')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### MultiIndexing and Advanced Indexing"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```{csv-table}\n",
    ":header-rows: 1\n",
    ":delim: ;\n",
    "\n",
    "Code; Description\n",
    "`pd.MultiIndex.from_*`; Set of methods which create multiindex from various sources such as tuples, arrays ...\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Setting multiple indexes on a dataframe."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>gender</th>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Female</th>\n",
       "      <th>10</th>\n",
       "      <td>ASSISTANT DIRECTOR (EX LVL)</td>\n",
       "      <td>Municipal Courts Department</td>\n",
       "      <td>121862.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2006-06-12</td>\n",
       "      <td>2012-10-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>LIBRARY ASSISTANT</td>\n",
       "      <td>Library</td>\n",
       "      <td>26125.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2000-07-19</td>\n",
       "      <td>2010-09-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"9\" valign=\"top\">Male</th>\n",
       "      <th>30</th>\n",
       "      <td>POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>45279.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2015-02-03</td>\n",
       "      <td>2015-02-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>ENGINEER/OPERATOR</td>\n",
       "      <td>Houston Fire Department (HFD)</td>\n",
       "      <td>63166.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>1982-02-08</td>\n",
       "      <td>1991-05-25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>ELECTRICIAN</td>\n",
       "      <td>General Services Department</td>\n",
       "      <td>56347.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>1989-06-19</td>\n",
       "      <td>1994-10-22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19960</th>\n",
       "      <td>POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>43443.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2014-06-09</td>\n",
       "      <td>2015-06-09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19970</th>\n",
       "      <td>COMMUNICATIONS CAPTAIN</td>\n",
       "      <td>Houston Fire Department (HFD)</td>\n",
       "      <td>66523.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2003-09-02</td>\n",
       "      <td>2013-10-06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19980</th>\n",
       "      <td>POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>43443.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2014-10-13</td>\n",
       "      <td>2015-10-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19990</th>\n",
       "      <td>POLICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>55461.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2009-01-20</td>\n",
       "      <td>2011-07-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20000</th>\n",
       "      <td>FIRE FIGHTER</td>\n",
       "      <td>Houston Fire Department (HFD)</td>\n",
       "      <td>51194.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2009-01-12</td>\n",
       "      <td>2010-07-12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2000 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                               position_title                     department  \\\n",
       "gender unique_id                                                               \n",
       "Female 10         ASSISTANT DIRECTOR (EX LVL)    Municipal Courts Department   \n",
       "       20                   LIBRARY ASSISTANT                        Library   \n",
       "Male   30                      POLICE OFFICER  Houston Police Department-HPD   \n",
       "       40                   ENGINEER/OPERATOR  Houston Fire Department (HFD)   \n",
       "       50                         ELECTRICIAN    General Services Department   \n",
       "...                                       ...                            ...   \n",
       "       19960                   POLICE OFFICER  Houston Police Department-HPD   \n",
       "       19970           COMMUNICATIONS CAPTAIN  Houston Fire Department (HFD)   \n",
       "       19980                   POLICE OFFICER  Houston Police Department-HPD   \n",
       "       19990                   POLICE OFFICER  Houston Police Department-HPD   \n",
       "       20000                     FIRE FIGHTER  Houston Fire Department (HFD)   \n",
       "\n",
       "                  base_salary employment_status   hire_date    job_date  \n",
       "gender unique_id                                                         \n",
       "Female 10            121862.0            Active  2006-06-12  2012-10-13  \n",
       "       20             26125.0            Active  2000-07-19  2010-09-18  \n",
       "Male   30             45279.0            Active  2015-02-03  2015-02-03  \n",
       "       40             63166.0            Active  1982-02-08  1991-05-25  \n",
       "       50             56347.0            Active  1989-06-19  1994-10-22  \n",
       "...                       ...               ...         ...         ...  \n",
       "       19960          43443.0            Active  2014-06-09  2015-06-09  \n",
       "       19970          66523.0            Active  2003-09-02  2013-10-06  \n",
       "       19980          43443.0            Active  2014-10-13  2015-10-13  \n",
       "       19990          55461.0            Active  2009-01-20  2011-07-02  \n",
       "       20000          51194.0            Active  2009-01-12  2010-07-12  \n",
       "\n",
       "[2000 rows x 6 columns]"
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "emp = pd.read_csv('data/employee.csv')\n",
    "emp = emp.set_index(['gender','unique_id'])\n",
    "emp"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>ASSISTANT DIRECTOR (EX LVL)</td>\n",
       "      <td>Municipal Courts Department</td>\n",
       "      <td>121862.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2006-06-12</td>\n",
       "      <td>2012-10-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>LIBRARY ASSISTANT</td>\n",
       "      <td>Library</td>\n",
       "      <td>26125.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2000-07-19</td>\n",
       "      <td>2010-09-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>360</th>\n",
       "      <td>DENTAL ASSISTANT</td>\n",
       "      <td>Health &amp; Human Services</td>\n",
       "      <td>34923.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>1982-04-05</td>\n",
       "      <td>1990-11-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>370</th>\n",
       "      <td>SENIOR INSPECTOR</td>\n",
       "      <td>Public Works &amp; Engineering-PWE</td>\n",
       "      <td>60258.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2004-08-03</td>\n",
       "      <td>2007-03-10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>390</th>\n",
       "      <td>SENIOR MICROCOMPUTER ANALYST</td>\n",
       "      <td>Health &amp; Human Services</td>\n",
       "      <td>67499.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>1994-06-29</td>\n",
       "      <td>1997-08-30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19770</th>\n",
       "      <td>SENIOR SIDELOADER OPERATOR</td>\n",
       "      <td>Solid Waste Management</td>\n",
       "      <td>34466.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2015-07-20</td>\n",
       "      <td>2016-01-30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19790</th>\n",
       "      <td>POLICE SERVICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>27914.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2011-10-14</td>\n",
       "      <td>2014-03-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19840</th>\n",
       "      <td>ADMINISTRATIVE SPECIALIST</td>\n",
       "      <td>Admn. &amp; Regulatory Affairs</td>\n",
       "      <td>55172.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2006-10-16</td>\n",
       "      <td>2006-10-16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19910</th>\n",
       "      <td>BUILDING MAINTENANCE SUPERVISOR</td>\n",
       "      <td>Parks &amp; Recreation</td>\n",
       "      <td>30347.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>1995-10-14</td>\n",
       "      <td>2010-03-20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19920</th>\n",
       "      <td>MOBILITY SERVICE OFFICER</td>\n",
       "      <td>Houston Police Department-HPD</td>\n",
       "      <td>44429.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2005-09-12</td>\n",
       "      <td>2007-06-02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>603 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                            position_title                      department  \\\n",
       "unique_id                                                                    \n",
       "10             ASSISTANT DIRECTOR (EX LVL)     Municipal Courts Department   \n",
       "20                       LIBRARY ASSISTANT                         Library   \n",
       "360                       DENTAL ASSISTANT         Health & Human Services   \n",
       "370                       SENIOR INSPECTOR  Public Works & Engineering-PWE   \n",
       "390           SENIOR MICROCOMPUTER ANALYST         Health & Human Services   \n",
       "...                                    ...                             ...   \n",
       "19770           SENIOR SIDELOADER OPERATOR          Solid Waste Management   \n",
       "19790               POLICE SERVICE OFFICER   Houston Police Department-HPD   \n",
       "19840            ADMINISTRATIVE SPECIALIST      Admn. & Regulatory Affairs   \n",
       "19910      BUILDING MAINTENANCE SUPERVISOR              Parks & Recreation   \n",
       "19920             MOBILITY SERVICE OFFICER   Houston Police Department-HPD   \n",
       "\n",
       "           base_salary employment_status   hire_date    job_date  \n",
       "unique_id                                                         \n",
       "10            121862.0            Active  2006-06-12  2012-10-13  \n",
       "20             26125.0            Active  2000-07-19  2010-09-18  \n",
       "360            34923.0            Active  1982-04-05  1990-11-03  \n",
       "370            60258.0            Active  2004-08-03  2007-03-10  \n",
       "390            67499.0            Active  1994-06-29  1997-08-30  \n",
       "...                ...               ...         ...         ...  \n",
       "19770          34466.0            Active  2015-07-20  2016-01-30  \n",
       "19790          27914.0            Active  2011-10-14  2014-03-01  \n",
       "19840          55172.0            Active  2006-10-16  2006-10-16  \n",
       "19910          30347.0            Active  1995-10-14  2010-03-20  \n",
       "19920          44429.0            Active  2005-09-12  2007-06-02  \n",
       "\n",
       "[603 rows x 6 columns]"
      ]
     },
     "execution_count": 117,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emp.loc['Female']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "position_title       ASSISTANT DIRECTOR (EX LVL)\n",
       "department           Municipal Courts Department\n",
       "base_salary                               121862\n",
       "employment_status                         Active\n",
       "hire_date                             2006-06-12\n",
       "job_date                              2012-10-13\n",
       "Name: 10, dtype: object"
      ]
     },
     "execution_count": 118,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emp.loc['Female'].loc[10]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setting options"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You can set options for pandas using `set_option` method e.g. `pd.set_option('display.width', None)`"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```{csv-table}\n",
    ":header-rows: 1\n",
    ":delim: ;\n",
    "\n",
    "Option; Description\n",
    "`display.width`; Use full width of terminal\n",
    "`display.max_columns`; Set as ``None`` to display all cols\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Text"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Refer to the following [link](https://pandas.pydata.org/docs/user_guide/text.html#method-summary) to get various string related methods and their uses."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "String methods are used as follows `Series.str.method()`, to chain follow the pattern  `Series.str.method().str.method()`"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Snippets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>position_title</th>\n",
       "      <th>department</th>\n",
       "      <th>base_salary</th>\n",
       "      <th>employment_status</th>\n",
       "      <th>hire_date</th>\n",
       "      <th>job_date</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>gender</th>\n",
       "      <th>unique_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Female</th>\n",
       "      <th>20</th>\n",
       "      <td>LIBRARY ASSISTANT</td>\n",
       "      <td>Library</td>\n",
       "      <td>26125.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2000-07-19</td>\n",
       "      <td>2010-09-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1020</th>\n",
       "      <td>CUSTOMER SERVICE CLERK</td>\n",
       "      <td>Library</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Active</td>\n",
       "      <td>2016-02-29</td>\n",
       "      <td>2016-02-29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">Male</th>\n",
       "      <th>2810</th>\n",
       "      <td>SENIOR CUSTOMER SERVICE CLERK</td>\n",
       "      <td>Library</td>\n",
       "      <td>31034.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2012-11-13</td>\n",
       "      <td>2015-12-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2990</th>\n",
       "      <td>SENIOR LIBRARY SERVICE SPECIALIST</td>\n",
       "      <td>Library</td>\n",
       "      <td>38563.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2012-03-05</td>\n",
       "      <td>2015-02-28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">Female</th>\n",
       "      <th>3090</th>\n",
       "      <td>LIBRARIAN II</td>\n",
       "      <td>Library</td>\n",
       "      <td>49317.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2014-08-04</td>\n",
       "      <td>2015-10-10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18470</th>\n",
       "      <td>LIBRARY ASSISTANT</td>\n",
       "      <td>Library</td>\n",
       "      <td>26125.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2008-05-05</td>\n",
       "      <td>2013-01-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Male</th>\n",
       "      <th>18970</th>\n",
       "      <td>DATA BASE ANALYST</td>\n",
       "      <td>Library</td>\n",
       "      <td>59371.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2005-08-06</td>\n",
       "      <td>2013-10-26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">Female</th>\n",
       "      <th>19270</th>\n",
       "      <td>LIBRARIAN I</td>\n",
       "      <td>Library</td>\n",
       "      <td>39874.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2009-02-11</td>\n",
       "      <td>2014-10-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19640</th>\n",
       "      <td>SENIOR COMMUNITY LIAISON</td>\n",
       "      <td>Library</td>\n",
       "      <td>51542.0</td>\n",
       "      <td>Active</td>\n",
       "      <td>2015-11-02</td>\n",
       "      <td>2015-11-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19690</th>\n",
       "      <td>CUSTOMER SERVICE CLERK</td>\n",
       "      <td>Library</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Active</td>\n",
       "      <td>2013-08-05</td>\n",
       "      <td>2013-08-05</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>36 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     position_title department  base_salary  \\\n",
       "gender unique_id                                                              \n",
       "Female 20                         LIBRARY ASSISTANT    Library      26125.0   \n",
       "       1020                  CUSTOMER SERVICE CLERK    Library          NaN   \n",
       "Male   2810           SENIOR CUSTOMER SERVICE CLERK    Library      31034.0   \n",
       "       2990       SENIOR LIBRARY SERVICE SPECIALIST    Library      38563.0   \n",
       "Female 3090                            LIBRARIAN II    Library      49317.0   \n",
       "...                                             ...        ...          ...   \n",
       "       18470                      LIBRARY ASSISTANT    Library      26125.0   \n",
       "Male   18970                      DATA BASE ANALYST    Library      59371.0   \n",
       "Female 19270                            LIBRARIAN I    Library      39874.0   \n",
       "       19640               SENIOR COMMUNITY LIAISON    Library      51542.0   \n",
       "       19690                 CUSTOMER SERVICE CLERK    Library          NaN   \n",
       "\n",
       "                 employment_status   hire_date    job_date  \n",
       "gender unique_id                                            \n",
       "Female 20                   Active  2000-07-19  2010-09-18  \n",
       "       1020                 Active  2016-02-29  2016-02-29  \n",
       "Male   2810                 Active  2012-11-13  2015-12-19  \n",
       "       2990                 Active  2012-03-05  2015-02-28  \n",
       "Female 3090                 Active  2014-08-04  2015-10-10  \n",
       "...                            ...         ...         ...  \n",
       "       18470                Active  2008-05-05  2013-01-19  \n",
       "Male   18970                Active  2005-08-06  2013-10-26  \n",
       "Female 19270                Active  2009-02-11  2014-10-11  \n",
       "       19640                Active  2015-11-02  2015-11-02  \n",
       "       19690                Active  2013-08-05  2013-08-05  \n",
       "\n",
       "[36 rows x 6 columns]"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emp[emp['department'].str.contains('Lib')]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 120,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "gender  unique_id\n",
       "Female  10              [municipal, courts, department]\n",
       "        20                                    [library]\n",
       "Male    30            [houston, police, department-hpd]\n",
       "        40           [houston, fire, department, (hfd)]\n",
       "        50              [general, services, department]\n",
       "                                    ...                \n",
       "        19960         [houston, police, department-hpd]\n",
       "        19970        [houston, fire, department, (hfd)]\n",
       "        19980         [houston, police, department-hpd]\n",
       "        19990         [houston, police, department-hpd]\n",
       "        20000        [houston, fire, department, (hfd)]\n",
       "Name: department, Length: 2000, dtype: object"
      ]
     },
     "execution_count": 120,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " emp['department'].str.lower().str.split()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Merge & Joins"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Grouping & Aggregations"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```{csv-table}\n",
    ":header-rows: 1\n",
    ":delim: ;\n",
    "\n",
    "Code; Description\n",
    "``df.groupby('colname')``; Groupby a single column\n",
    "``df.groupby(['colname', 'colname'])``; Groupby multiple columns in order of listing\n",
    "`df.groupby(colname)[col].agg(agg_function)`; Aggregate on a column after group by\n",
    "``df.groupby([col, col])[[col, col]].agg([func1, func2])``; Aggregate multiple funcs on multi column after group by on multi cols.\n",
    "``df.groupby([col, col])[[col, col]].agg({col:[func1, func2], col[func3, func4]})``; Aggregate multiple funcs on multi column after group by on multi cols. (Seperate aggregation for seperate cols.)\n",
    "``df.groupby(colname)[col].agg(agg_function).rename(columns = {})``; rename cols\n",
    "``df.groupby(colname).agg(final_col_name = pd.NamedAgg(column=aggregate_on_col, aggfunc=func_name))``; Named Aggregation\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Snippets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MONTH</th>\n",
       "      <th>DAY</th>\n",
       "      <th>WEEKDAY</th>\n",
       "      <th>AIRLINE</th>\n",
       "      <th>ORG_AIR</th>\n",
       "      <th>DEST_AIR</th>\n",
       "      <th>SCHED_DEP</th>\n",
       "      <th>DEP_DELAY</th>\n",
       "      <th>AIR_TIME</th>\n",
       "      <th>DIST</th>\n",
       "      <th>SCHED_ARR</th>\n",
       "      <th>ARR_DELAY</th>\n",
       "      <th>DIVERTED</th>\n",
       "      <th>CANCELLED</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>WN</td>\n",
       "      <td>LAX</td>\n",
       "      <td>SLC</td>\n",
       "      <td>1625</td>\n",
       "      <td>58.0</td>\n",
       "      <td>94.0</td>\n",
       "      <td>590</td>\n",
       "      <td>1905</td>\n",
       "      <td>65.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>UA</td>\n",
       "      <td>DEN</td>\n",
       "      <td>IAD</td>\n",
       "      <td>823</td>\n",
       "      <td>7.0</td>\n",
       "      <td>154.0</td>\n",
       "      <td>1452</td>\n",
       "      <td>1333</td>\n",
       "      <td>-13.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>MQ</td>\n",
       "      <td>DFW</td>\n",
       "      <td>VPS</td>\n",
       "      <td>1305</td>\n",
       "      <td>36.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>641</td>\n",
       "      <td>1453</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>AA</td>\n",
       "      <td>DFW</td>\n",
       "      <td>DCA</td>\n",
       "      <td>1555</td>\n",
       "      <td>7.0</td>\n",
       "      <td>126.0</td>\n",
       "      <td>1192</td>\n",
       "      <td>1935</td>\n",
       "      <td>-7.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>WN</td>\n",
       "      <td>LAX</td>\n",
       "      <td>MCI</td>\n",
       "      <td>1720</td>\n",
       "      <td>48.0</td>\n",
       "      <td>166.0</td>\n",
       "      <td>1363</td>\n",
       "      <td>2225</td>\n",
       "      <td>39.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58487</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>AA</td>\n",
       "      <td>SFO</td>\n",
       "      <td>DFW</td>\n",
       "      <td>515</td>\n",
       "      <td>5.0</td>\n",
       "      <td>166.0</td>\n",
       "      <td>1464</td>\n",
       "      <td>1045</td>\n",
       "      <td>-19.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58488</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>F9</td>\n",
       "      <td>LAS</td>\n",
       "      <td>SFO</td>\n",
       "      <td>1910</td>\n",
       "      <td>13.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>414</td>\n",
       "      <td>2050</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58489</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>OO</td>\n",
       "      <td>SFO</td>\n",
       "      <td>SBA</td>\n",
       "      <td>1846</td>\n",
       "      <td>-6.0</td>\n",
       "      <td>46.0</td>\n",
       "      <td>262</td>\n",
       "      <td>1956</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58490</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>WN</td>\n",
       "      <td>MSP</td>\n",
       "      <td>ATL</td>\n",
       "      <td>525</td>\n",
       "      <td>39.0</td>\n",
       "      <td>124.0</td>\n",
       "      <td>907</td>\n",
       "      <td>855</td>\n",
       "      <td>34.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58491</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>OO</td>\n",
       "      <td>SFO</td>\n",
       "      <td>BOI</td>\n",
       "      <td>859</td>\n",
       "      <td>5.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>522</td>\n",
       "      <td>1146</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>58492 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       MONTH  DAY  WEEKDAY AIRLINE ORG_AIR DEST_AIR  SCHED_DEP  DEP_DELAY  \\\n",
       "0          1    1        4      WN     LAX      SLC       1625       58.0   \n",
       "1          1    1        4      UA     DEN      IAD        823        7.0   \n",
       "2          1    1        4      MQ     DFW      VPS       1305       36.0   \n",
       "3          1    1        4      AA     DFW      DCA       1555        7.0   \n",
       "4          1    1        4      WN     LAX      MCI       1720       48.0   \n",
       "...      ...  ...      ...     ...     ...      ...        ...        ...   \n",
       "58487     12   31        4      AA     SFO      DFW        515        5.0   \n",
       "58488     12   31        4      F9     LAS      SFO       1910       13.0   \n",
       "58489     12   31        4      OO     SFO      SBA       1846       -6.0   \n",
       "58490     12   31        4      WN     MSP      ATL        525       39.0   \n",
       "58491     12   31        4      OO     SFO      BOI        859        5.0   \n",
       "\n",
       "       AIR_TIME  DIST  SCHED_ARR  ARR_DELAY  DIVERTED  CANCELLED  \n",
       "0          94.0   590       1905       65.0         0          0  \n",
       "1         154.0  1452       1333      -13.0         0          0  \n",
       "2          85.0   641       1453       35.0         0          0  \n",
       "3         126.0  1192       1935       -7.0         0          0  \n",
       "4         166.0  1363       2225       39.0         0          0  \n",
       "...         ...   ...        ...        ...       ...        ...  \n",
       "58487     166.0  1464       1045      -19.0         0          0  \n",
       "58488      71.0   414       2050        4.0         0          0  \n",
       "58489      46.0   262       1956       -5.0         0          0  \n",
       "58490     124.0   907        855       34.0         0          0  \n",
       "58491      73.0   522       1146       -1.0         0          0  \n",
       "\n",
       "[58492 rows x 14 columns]"
      ]
     },
     "execution_count": 121,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights = pd.read_csv('data/flights.csv')\n",
    "flights"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"8\" halign=\"left\">MONTH</th>\n",
       "      <th colspan=\"2\" halign=\"left\">DAY</th>\n",
       "      <th>...</th>\n",
       "      <th colspan=\"2\" halign=\"left\">DIVERTED</th>\n",
       "      <th colspan=\"8\" halign=\"left\">CANCELLED</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>...</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AIRLINE</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>AA</th>\n",
       "      <td>8900.0</td>\n",
       "      <td>6.661461</td>\n",
       "      <td>3.386332</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.00</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>8900.0</td>\n",
       "      <td>15.570562</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>8900.0</td>\n",
       "      <td>0.017303</td>\n",
       "      <td>0.130407</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AS</th>\n",
       "      <td>768.0</td>\n",
       "      <td>6.197917</td>\n",
       "      <td>3.343428</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.75</td>\n",
       "      <td>6.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>768.0</td>\n",
       "      <td>15.247396</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>768.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>B6</th>\n",
       "      <td>543.0</td>\n",
       "      <td>6.368324</td>\n",
       "      <td>3.380085</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.00</td>\n",
       "      <td>6.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>543.0</td>\n",
       "      <td>15.788214</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>543.0</td>\n",
       "      <td>0.001842</td>\n",
       "      <td>0.042914</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DL</th>\n",
       "      <td>10601.0</td>\n",
       "      <td>6.277332</td>\n",
       "      <td>3.340809</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.00</td>\n",
       "      <td>6.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>10601.0</td>\n",
       "      <td>15.721158</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>10601.0</td>\n",
       "      <td>0.003585</td>\n",
       "      <td>0.059767</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>EV</th>\n",
       "      <td>5858.0</td>\n",
       "      <td>6.003926</td>\n",
       "      <td>3.318475</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.00</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>5858.0</td>\n",
       "      <td>15.866166</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5858.0</td>\n",
       "      <td>0.024923</td>\n",
       "      <td>0.155904</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>OO</th>\n",
       "      <td>6588.0</td>\n",
       "      <td>6.134791</td>\n",
       "      <td>3.331999</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.00</td>\n",
       "      <td>6.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>6588.0</td>\n",
       "      <td>15.651943</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6588.0</td>\n",
       "      <td>0.021554</td>\n",
       "      <td>0.145234</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>UA</th>\n",
       "      <td>7792.0</td>\n",
       "      <td>6.322510</td>\n",
       "      <td>3.326315</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.00</td>\n",
       "      <td>6.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>7792.0</td>\n",
       "      <td>15.697510</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7792.0</td>\n",
       "      <td>0.011935</td>\n",
       "      <td>0.108602</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>US</th>\n",
       "      <td>1615.0</td>\n",
       "      <td>3.628483</td>\n",
       "      <td>1.714630</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.00</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1615.0</td>\n",
       "      <td>16.079876</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1615.0</td>\n",
       "      <td>0.013003</td>\n",
       "      <td>0.113322</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>VX</th>\n",
       "      <td>993.0</td>\n",
       "      <td>6.336354</td>\n",
       "      <td>3.439813</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.00</td>\n",
       "      <td>6.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>993.0</td>\n",
       "      <td>15.518630</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>993.0</td>\n",
       "      <td>0.006042</td>\n",
       "      <td>0.077536</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WN</th>\n",
       "      <td>8418.0</td>\n",
       "      <td>6.298646</td>\n",
       "      <td>3.373491</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.00</td>\n",
       "      <td>6.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>8418.0</td>\n",
       "      <td>15.746971</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>8418.0</td>\n",
       "      <td>0.011048</td>\n",
       "      <td>0.104532</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14 rows × 88 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           MONTH                                                     DAY  \\\n",
       "           count      mean       std  min   25%  50%  75%   max    count   \n",
       "AIRLINE                                                                    \n",
       "AA        8900.0  6.661461  3.386332  1.0  4.00  7.0  9.0  12.0   8900.0   \n",
       "AS         768.0  6.197917  3.343428  1.0  3.75  6.0  9.0  12.0    768.0   \n",
       "B6         543.0  6.368324  3.380085  1.0  4.00  6.0  9.0  12.0    543.0   \n",
       "DL       10601.0  6.277332  3.340809  1.0  3.00  6.0  9.0  12.0  10601.0   \n",
       "EV        5858.0  6.003926  3.318475  1.0  3.00  6.0  8.0  12.0   5858.0   \n",
       "...          ...       ...       ...  ...   ...  ...  ...   ...      ...   \n",
       "OO        6588.0  6.134791  3.331999  1.0  3.00  6.0  9.0  12.0   6588.0   \n",
       "UA        7792.0  6.322510  3.326315  1.0  4.00  6.0  9.0  12.0   7792.0   \n",
       "US        1615.0  3.628483  1.714630  1.0  2.00  4.0  5.0   6.0   1615.0   \n",
       "VX         993.0  6.336354  3.439813  1.0  4.00  6.0  9.0  12.0    993.0   \n",
       "WN        8418.0  6.298646  3.373491  1.0  3.00  6.0  9.0  12.0   8418.0   \n",
       "\n",
       "                    ... DIVERTED      CANCELLED                                \\\n",
       "              mean  ...      75%  max     count      mean       std  min  25%   \n",
       "AIRLINE             ...                                                         \n",
       "AA       15.570562  ...      0.0  1.0    8900.0  0.017303  0.130407  0.0  0.0   \n",
       "AS       15.247396  ...      0.0  0.0     768.0  0.000000  0.000000  0.0  0.0   \n",
       "B6       15.788214  ...      0.0  1.0     543.0  0.001842  0.042914  0.0  0.0   \n",
       "DL       15.721158  ...      0.0  1.0   10601.0  0.003585  0.059767  0.0  0.0   \n",
       "EV       15.866166  ...      0.0  1.0    5858.0  0.024923  0.155904  0.0  0.0   \n",
       "...            ...  ...      ...  ...       ...       ...       ...  ...  ...   \n",
       "OO       15.651943  ...      0.0  1.0    6588.0  0.021554  0.145234  0.0  0.0   \n",
       "UA       15.697510  ...      0.0  1.0    7792.0  0.011935  0.108602  0.0  0.0   \n",
       "US       16.079876  ...      0.0  1.0    1615.0  0.013003  0.113322  0.0  0.0   \n",
       "VX       15.518630  ...      0.0  1.0     993.0  0.006042  0.077536  0.0  0.0   \n",
       "WN       15.746971  ...      0.0  1.0    8418.0  0.011048  0.104532  0.0  0.0   \n",
       "\n",
       "                        \n",
       "         50%  75%  max  \n",
       "AIRLINE                 \n",
       "AA       0.0  0.0  1.0  \n",
       "AS       0.0  0.0  0.0  \n",
       "B6       0.0  0.0  1.0  \n",
       "DL       0.0  0.0  1.0  \n",
       "EV       0.0  0.0  1.0  \n",
       "...      ...  ...  ...  \n",
       "OO       0.0  0.0  1.0  \n",
       "UA       0.0  0.0  1.0  \n",
       "US       0.0  0.0  1.0  \n",
       "VX       0.0  0.0  1.0  \n",
       "WN       0.0  0.0  1.0  \n",
       "\n",
       "[14 rows x 88 columns]"
      ]
     },
     "execution_count": 122,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights.groupby('AIRLINE').describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "AIRLINE\n",
       "AA    11.274057\n",
       "AS     1.808594\n",
       "B6    14.287823\n",
       "DL     7.242450\n",
       "EV     9.092625\n",
       "        ...    \n",
       "OO     9.662279\n",
       "UA    16.210485\n",
       "US     4.361355\n",
       "VX     8.918946\n",
       "WN    12.639366\n",
       "Name: DEP_DELAY, Length: 14, dtype: float64"
      ]
     },
     "execution_count": 123,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights.groupby('AIRLINE')['DEP_DELAY'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th colspan=\"3\" halign=\"left\">CANCELLED</th>\n",
       "      <th colspan=\"3\" halign=\"left\">DIVERTED</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>sum</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>sum</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AIRLINE</th>\n",
       "      <th>WEEKDAY</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">AA</th>\n",
       "      <th>1</th>\n",
       "      <td>41</td>\n",
       "      <td>0.032106</td>\n",
       "      <td>0.176352</td>\n",
       "      <td>6</td>\n",
       "      <td>0.004699</td>\n",
       "      <td>0.068411</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>9</td>\n",
       "      <td>0.007341</td>\n",
       "      <td>0.085399</td>\n",
       "      <td>2</td>\n",
       "      <td>0.001631</td>\n",
       "      <td>0.040373</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>16</td>\n",
       "      <td>0.011949</td>\n",
       "      <td>0.108698</td>\n",
       "      <td>2</td>\n",
       "      <td>0.001494</td>\n",
       "      <td>0.038633</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>20</td>\n",
       "      <td>0.015004</td>\n",
       "      <td>0.121613</td>\n",
       "      <td>5</td>\n",
       "      <td>0.003751</td>\n",
       "      <td>0.061153</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>18</td>\n",
       "      <td>0.014151</td>\n",
       "      <td>0.118160</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000786</td>\n",
       "      <td>0.028039</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">WN</th>\n",
       "      <th>3</th>\n",
       "      <td>18</td>\n",
       "      <td>0.014118</td>\n",
       "      <td>0.118022</td>\n",
       "      <td>2</td>\n",
       "      <td>0.001569</td>\n",
       "      <td>0.039590</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10</td>\n",
       "      <td>0.007911</td>\n",
       "      <td>0.088629</td>\n",
       "      <td>4</td>\n",
       "      <td>0.003165</td>\n",
       "      <td>0.056188</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>7</td>\n",
       "      <td>0.005828</td>\n",
       "      <td>0.076153</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>10</td>\n",
       "      <td>0.010132</td>\n",
       "      <td>0.100196</td>\n",
       "      <td>3</td>\n",
       "      <td>0.003040</td>\n",
       "      <td>0.055076</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>0.006066</td>\n",
       "      <td>0.077681</td>\n",
       "      <td>3</td>\n",
       "      <td>0.002600</td>\n",
       "      <td>0.050943</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>98 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                CANCELLED                     DIVERTED                    \n",
       "                      sum      mean       std      sum      mean       std\n",
       "AIRLINE WEEKDAY                                                           \n",
       "AA      1              41  0.032106  0.176352        6  0.004699  0.068411\n",
       "        2               9  0.007341  0.085399        2  0.001631  0.040373\n",
       "        3              16  0.011949  0.108698        2  0.001494  0.038633\n",
       "        4              20  0.015004  0.121613        5  0.003751  0.061153\n",
       "        5              18  0.014151  0.118160        1  0.000786  0.028039\n",
       "...                   ...       ...       ...      ...       ...       ...\n",
       "WN      3              18  0.014118  0.118022        2  0.001569  0.039590\n",
       "        4              10  0.007911  0.088629        4  0.003165  0.056188\n",
       "        5               7  0.005828  0.076153        0  0.000000  0.000000\n",
       "        6              10  0.010132  0.100196        3  0.003040  0.055076\n",
       "        7               7  0.006066  0.077681        3  0.002600  0.050943\n",
       "\n",
       "[98 rows x 6 columns]"
      ]
     },
     "execution_count": 124,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights.groupby(['AIRLINE', 'WEEKDAY'])[['CANCELLED', 'DIVERTED']].agg([np.sum, np.mean, np.std])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 125,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th>AIRLINE</th>\n",
       "      <th>CANCELLED</th>\n",
       "      <th colspan=\"2\" halign=\"left\">DEP_DELAY</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th>Total Flights</th>\n",
       "      <th>Total Cancelled</th>\n",
       "      <th>Average Delay</th>\n",
       "      <th>Standard Deviation</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AIRLINE</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>AA</th>\n",
       "      <td>8900</td>\n",
       "      <td>154</td>\n",
       "      <td>11.274057</td>\n",
       "      <td>40.787806</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AS</th>\n",
       "      <td>768</td>\n",
       "      <td>0</td>\n",
       "      <td>1.808594</td>\n",
       "      <td>29.543702</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>B6</th>\n",
       "      <td>543</td>\n",
       "      <td>1</td>\n",
       "      <td>14.287823</td>\n",
       "      <td>36.863416</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DL</th>\n",
       "      <td>10601</td>\n",
       "      <td>38</td>\n",
       "      <td>7.242450</td>\n",
       "      <td>29.759377</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>EV</th>\n",
       "      <td>5858</td>\n",
       "      <td>146</td>\n",
       "      <td>9.092625</td>\n",
       "      <td>34.582917</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>OO</th>\n",
       "      <td>6588</td>\n",
       "      <td>142</td>\n",
       "      <td>9.662279</td>\n",
       "      <td>33.413767</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>UA</th>\n",
       "      <td>7792</td>\n",
       "      <td>93</td>\n",
       "      <td>16.210485</td>\n",
       "      <td>44.834336</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>US</th>\n",
       "      <td>1615</td>\n",
       "      <td>21</td>\n",
       "      <td>4.361355</td>\n",
       "      <td>24.550930</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>VX</th>\n",
       "      <td>993</td>\n",
       "      <td>6</td>\n",
       "      <td>8.918946</td>\n",
       "      <td>31.782085</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WN</th>\n",
       "      <td>8418</td>\n",
       "      <td>93</td>\n",
       "      <td>12.639366</td>\n",
       "      <td>30.506549</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              AIRLINE       CANCELLED     DEP_DELAY                   \n",
       "        Total Flights Total Cancelled Average Delay Standard Deviation\n",
       "AIRLINE                                                               \n",
       "AA               8900             154     11.274057          40.787806\n",
       "AS                768               0      1.808594          29.543702\n",
       "B6                543               1     14.287823          36.863416\n",
       "DL              10601              38      7.242450          29.759377\n",
       "EV               5858             146      9.092625          34.582917\n",
       "...               ...             ...           ...                ...\n",
       "OO               6588             142      9.662279          33.413767\n",
       "UA               7792              93     16.210485          44.834336\n",
       "US               1615              21      4.361355          24.550930\n",
       "VX                993               6      8.918946          31.782085\n",
       "WN               8418              93     12.639366          30.506549\n",
       "\n",
       "[14 rows x 4 columns]"
      ]
     },
     "execution_count": 125,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights.groupby(['AIRLINE'])[['AIRLINE','CANCELLED', 'DEP_DELAY']]\\\n",
    "    .agg({'AIRLINE':'count','CANCELLED':[np.sum], 'DEP_DELAY':[np.mean, np.std]})\\\n",
    "    .rename(columns={'count':'Total Flights', 'sum':'Total Cancelled','std':'Standard Deviation', 'mean':'Average Delay'})"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Named Aggregation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Total Flights</th>\n",
       "      <th>Total Cancelled</th>\n",
       "      <th>Average_Delay</th>\n",
       "      <th>Std Dev on Departure Delay</th>\n",
       "      <th>Funny Val</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AIRLINE</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>AA</th>\n",
       "      <td>8900</td>\n",
       "      <td>154</td>\n",
       "      <td>11.274057</td>\n",
       "      <td>40.787806</td>\n",
       "      <td>42.785475</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AS</th>\n",
       "      <td>768</td>\n",
       "      <td>0</td>\n",
       "      <td>1.808594</td>\n",
       "      <td>29.543702</td>\n",
       "      <td>31.524462</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>B6</th>\n",
       "      <td>543</td>\n",
       "      <td>1</td>\n",
       "      <td>14.287823</td>\n",
       "      <td>36.863416</td>\n",
       "      <td>38.829394</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DL</th>\n",
       "      <td>10601</td>\n",
       "      <td>38</td>\n",
       "      <td>7.242450</td>\n",
       "      <td>29.759377</td>\n",
       "      <td>31.757969</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>EV</th>\n",
       "      <td>5858</td>\n",
       "      <td>146</td>\n",
       "      <td>9.092625</td>\n",
       "      <td>34.582917</td>\n",
       "      <td>36.579895</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>OO</th>\n",
       "      <td>6588</td>\n",
       "      <td>142</td>\n",
       "      <td>9.662279</td>\n",
       "      <td>33.413767</td>\n",
       "      <td>35.411180</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>UA</th>\n",
       "      <td>7792</td>\n",
       "      <td>93</td>\n",
       "      <td>16.210485</td>\n",
       "      <td>44.834336</td>\n",
       "      <td>46.831427</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>US</th>\n",
       "      <td>1615</td>\n",
       "      <td>21</td>\n",
       "      <td>4.361355</td>\n",
       "      <td>24.550930</td>\n",
       "      <td>26.543228</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>VX</th>\n",
       "      <td>993</td>\n",
       "      <td>6</td>\n",
       "      <td>8.918946</td>\n",
       "      <td>31.782085</td>\n",
       "      <td>33.765981</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WN</th>\n",
       "      <td>8418</td>\n",
       "      <td>93</td>\n",
       "      <td>12.639366</td>\n",
       "      <td>30.506549</td>\n",
       "      <td>32.504717</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Total Flights  Total Cancelled  Average_Delay  \\\n",
       "AIRLINE                                                  \n",
       "AA                8900              154      11.274057   \n",
       "AS                 768                0       1.808594   \n",
       "B6                 543                1      14.287823   \n",
       "DL               10601               38       7.242450   \n",
       "EV                5858              146       9.092625   \n",
       "...                ...              ...            ...   \n",
       "OO                6588              142       9.662279   \n",
       "UA                7792               93      16.210485   \n",
       "US                1615               21       4.361355   \n",
       "VX                 993                6       8.918946   \n",
       "WN                8418               93      12.639366   \n",
       "\n",
       "         Std Dev on Departure Delay  Funny Val  \n",
       "AIRLINE                                         \n",
       "AA                        40.787806  42.785475  \n",
       "AS                        29.543702  31.524462  \n",
       "B6                        36.863416  38.829394  \n",
       "DL                        29.759377  31.757969  \n",
       "EV                        34.582917  36.579895  \n",
       "...                             ...        ...  \n",
       "OO                        33.413767  35.411180  \n",
       "UA                        44.834336  46.831427  \n",
       "US                        24.550930  26.543228  \n",
       "VX                        31.782085  33.765981  \n",
       "WN                        30.506549  32.504717  \n",
       "\n",
       "[14 rows x 5 columns]"
      ]
     },
     "execution_count": 126,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights.groupby(['AIRLINE'])\\\n",
    "    .agg(\n",
    "         **{\n",
    "             \"Total Flights\":pd.NamedAgg(column='AIRLINE',aggfunc='count'),\n",
    "             \"Total Cancelled\":pd.NamedAgg(column='CANCELLED',aggfunc=np.sum),\n",
    "             \"Average_Delay\":pd.NamedAgg(column='DEP_DELAY',aggfunc=np.mean),\n",
    "             \"Std Dev on Departure Delay\":pd.NamedAgg(column='DEP_DELAY',aggfunc=np.std),\n",
    "             \"Funny Val\":pd.NamedAgg(column='DEP_DELAY',aggfunc=lambda x: (np.std(x) + 2))  # Can supply lambda as well.\n",
    "         }\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MONTH</th>\n",
       "      <th>DAY</th>\n",
       "      <th>WEEKDAY</th>\n",
       "      <th>AIRLINE</th>\n",
       "      <th>ORG_AIR</th>\n",
       "      <th>DEST_AIR</th>\n",
       "      <th>SCHED_DEP</th>\n",
       "      <th>DEP_DELAY</th>\n",
       "      <th>AIR_TIME</th>\n",
       "      <th>DIST</th>\n",
       "      <th>SCHED_ARR</th>\n",
       "      <th>ARR_DELAY</th>\n",
       "      <th>DIVERTED</th>\n",
       "      <th>CANCELLED</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>WN</td>\n",
       "      <td>LAX</td>\n",
       "      <td>SLC</td>\n",
       "      <td>1625</td>\n",
       "      <td>58.0</td>\n",
       "      <td>94.0</td>\n",
       "      <td>590</td>\n",
       "      <td>1905</td>\n",
       "      <td>65.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>UA</td>\n",
       "      <td>DEN</td>\n",
       "      <td>IAD</td>\n",
       "      <td>823</td>\n",
       "      <td>7.0</td>\n",
       "      <td>154.0</td>\n",
       "      <td>1452</td>\n",
       "      <td>1333</td>\n",
       "      <td>-13.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>MQ</td>\n",
       "      <td>DFW</td>\n",
       "      <td>VPS</td>\n",
       "      <td>1305</td>\n",
       "      <td>36.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>641</td>\n",
       "      <td>1453</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>AA</td>\n",
       "      <td>DFW</td>\n",
       "      <td>DCA</td>\n",
       "      <td>1555</td>\n",
       "      <td>7.0</td>\n",
       "      <td>126.0</td>\n",
       "      <td>1192</td>\n",
       "      <td>1935</td>\n",
       "      <td>-7.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>WN</td>\n",
       "      <td>LAX</td>\n",
       "      <td>MCI</td>\n",
       "      <td>1720</td>\n",
       "      <td>48.0</td>\n",
       "      <td>166.0</td>\n",
       "      <td>1363</td>\n",
       "      <td>2225</td>\n",
       "      <td>39.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58487</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>AA</td>\n",
       "      <td>SFO</td>\n",
       "      <td>DFW</td>\n",
       "      <td>515</td>\n",
       "      <td>5.0</td>\n",
       "      <td>166.0</td>\n",
       "      <td>1464</td>\n",
       "      <td>1045</td>\n",
       "      <td>-19.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58488</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>F9</td>\n",
       "      <td>LAS</td>\n",
       "      <td>SFO</td>\n",
       "      <td>1910</td>\n",
       "      <td>13.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>414</td>\n",
       "      <td>2050</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58489</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>OO</td>\n",
       "      <td>SFO</td>\n",
       "      <td>SBA</td>\n",
       "      <td>1846</td>\n",
       "      <td>-6.0</td>\n",
       "      <td>46.0</td>\n",
       "      <td>262</td>\n",
       "      <td>1956</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58490</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>WN</td>\n",
       "      <td>MSP</td>\n",
       "      <td>ATL</td>\n",
       "      <td>525</td>\n",
       "      <td>39.0</td>\n",
       "      <td>124.0</td>\n",
       "      <td>907</td>\n",
       "      <td>855</td>\n",
       "      <td>34.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58491</th>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>4</td>\n",
       "      <td>OO</td>\n",
       "      <td>SFO</td>\n",
       "      <td>BOI</td>\n",
       "      <td>859</td>\n",
       "      <td>5.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>522</td>\n",
       "      <td>1146</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>58492 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       MONTH  DAY  WEEKDAY AIRLINE ORG_AIR DEST_AIR  SCHED_DEP  DEP_DELAY  \\\n",
       "0          1    1        4      WN     LAX      SLC       1625       58.0   \n",
       "1          1    1        4      UA     DEN      IAD        823        7.0   \n",
       "2          1    1        4      MQ     DFW      VPS       1305       36.0   \n",
       "3          1    1        4      AA     DFW      DCA       1555        7.0   \n",
       "4          1    1        4      WN     LAX      MCI       1720       48.0   \n",
       "...      ...  ...      ...     ...     ...      ...        ...        ...   \n",
       "58487     12   31        4      AA     SFO      DFW        515        5.0   \n",
       "58488     12   31        4      F9     LAS      SFO       1910       13.0   \n",
       "58489     12   31        4      OO     SFO      SBA       1846       -6.0   \n",
       "58490     12   31        4      WN     MSP      ATL        525       39.0   \n",
       "58491     12   31        4      OO     SFO      BOI        859        5.0   \n",
       "\n",
       "       AIR_TIME  DIST  SCHED_ARR  ARR_DELAY  DIVERTED  CANCELLED  \n",
       "0          94.0   590       1905       65.0         0          0  \n",
       "1         154.0  1452       1333      -13.0         0          0  \n",
       "2          85.0   641       1453       35.0         0          0  \n",
       "3         126.0  1192       1935       -7.0         0          0  \n",
       "4         166.0  1363       2225       39.0         0          0  \n",
       "...         ...   ...        ...        ...       ...        ...  \n",
       "58487     166.0  1464       1045      -19.0         0          0  \n",
       "58488      71.0   414       2050        4.0         0          0  \n",
       "58489      46.0   262       1956       -5.0         0          0  \n",
       "58490     124.0   907        855       34.0         0          0  \n",
       "58491      73.0   522       1146       -1.0         0          0  \n",
       "\n",
       "[58492 rows x 14 columns]"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## TimeSeries"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Working with dates and times is a complex topic, only a small subset of functionality is covered here."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "While working with pandas timeseries you can use the following time related concepts\n",
    "\n",
    "- Date time - A specific date and time with timezone support \n",
    "- Time deltas - absolute time duration\n",
    "- Time Spans -  A span of time defined by a point in time and its associated frequency.\n",
    "- Date Offsets - A relative time duration that respects calendar arithmetic.\n",
    "\n",
    "For details on the methods refer to the following [link](https://pandas.pydata.org/docs/user_guide/timeseries.html#overview)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```{csv-table}\n",
    ":header-rows: 1\n",
    ":delim: ;\n",
    "\n",
    "Code; Description\n",
    "``pd.date_range('2020-01-01', periods=10,freq='H')``; Creating dates\n",
    "``pd.Timedelta``; Used for arithmetic of date and time\n",
    "``df['col'].astype('datetime64')``; Convert to datetype. For timezone use ``'datetime64[ns, US/Eastern]'`` Supports from nanosec to weeks.\n",
    "``pd.to_datetime(df['col'])``; Converts to datetime from various formats.\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "TimeDelta for calculations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Timestamp('2020-01-02 00:00:00')"
      ]
     },
     "execution_count": 128,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "day1 = pd.Timestamp('2020-01-01')\n",
    "day1 + pd.Timedelta(1, 'D')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Convert objects to datetime"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "metadata": {},
   "outputs": [],
   "source": [
    "emp['hire_date'] = emp.hire_date.astype('datetime64')\n",
    "emp['job_date'] = emp.job_date.astype('datetime64')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.6"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": true,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}